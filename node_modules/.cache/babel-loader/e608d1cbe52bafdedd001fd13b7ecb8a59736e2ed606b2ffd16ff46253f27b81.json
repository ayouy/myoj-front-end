{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.reduce.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport get from 'lodash/get';\nimport setWith from 'lodash/setWith';\nimport has from 'lodash/has';\nimport omit from 'lodash/omit';\nimport { cloneDeep, set, iterativelyGetKeys } from './utils';\nimport { isArray, isFunction, isObject, isExist } from '../_util/is';\nimport { SubmitStatus } from './interface';\nimport promisify from './promisify';\nvar Store = /** @class */function () {\n  function Store() {\n    var _this = this;\n    // 表示的 Form 的提交状态而非单个字段的提交状态。\n    // 只有在触发表单 reset（原生 reset，而非当前的 resetFields） 时，才会回到  init 状态（目前没有支持 form.reset，所以没有这块逻辑）\n    this.submitStatus = SubmitStatus.init;\n    this.registerFields = [];\n    // 所有 form item value 的变动，都会通知这里注册到的 watcher\n    this.registerWatchers = [];\n    // 所有 form item 内部 errors, validating, touched 状态的变化，都会通知这里注册到的 watcher\n    // TODO: 合并 registerWatchers\n    this.registerStateWatchers = [];\n    // 所有 form 整体 的变动，都会通知这里注册到的 watcher\n    this.registerFormWatchers = [];\n    // 和formControl 的 touched属性不一样。 只要被改过的字段，这里就会存储。并且不会跟随formControl被卸载而清除。\n    // reset 的时候清除\n    this.touchedFields = {};\n    this.store = {};\n    this.initialValues = {};\n    this.callbacks = {};\n    // 告知 form 状态改变，进行状态收集\n    this.innerCollectFormState = function () {\n      _this.notifyStateWatchers();\n    };\n    this.innerSetCallbacks = function (values) {\n      _this.callbacks = values;\n    };\n    this.registerFormWatcher = function (item) {\n      _this.registerFormWatchers.push(item);\n      return function () {\n        _this.registerFormWatchers = _this.registerFormWatchers.filter(function (x) {\n          return x !== item;\n        });\n      };\n    };\n    this.registerStateWatcher = function (item) {\n      _this.registerStateWatchers.push(item);\n      return function () {\n        _this.registerStateWatchers = _this.registerStateWatchers.filter(function (x) {\n          return x !== item;\n        });\n      };\n    };\n    this.registerWatcher = function (item) {\n      _this.registerWatchers.push(item);\n      return function () {\n        _this.registerWatchers = _this.registerWatchers.filter(function (x) {\n          return x !== item;\n        });\n      };\n    };\n    // 收集所有control字段，并在组件卸载时移除\n    this.registerField = function (item) {\n      _this.registerFields.push(item);\n      _this.notifyWatchers();\n      return function () {\n        _this.registerFields = _this.registerFields.filter(function (x) {\n          return x !== item;\n        });\n        _this.notifyWatchers();\n      };\n    };\n    // hasField为true时，只返回传入field属性的control实例\n    // isFormList 目前只在校验时需要包含\n    // TODO formlist 实现缺陷，待优化\n    this.getRegisteredFields = function (hasField, options) {\n      if (hasField) {\n        return _this.registerFields.filter(function (control) {\n          var _a;\n          return control.hasFieldProps() && ((options === null || options === void 0 ? void 0 : options.containFormList) || !((_a = control.props) === null || _a === void 0 ? void 0 : _a.isFormList));\n        });\n      }\n      return _this.registerFields;\n    };\n    // 获取props.field === field 的control组件。\n    this.getRegisteredField = function (field) {\n      return _this.registerFields.filter(function (x) {\n        return x.props.field === field;\n      })[0];\n    };\n    // 通知所有的FormItem进行更新。\n    // setFieldValue: 外部调用setFieldsValue (setFieldValue等)方法触发更新\n    // innerSetValue: 控件例如Input，通过onChange事件触发的更新\n    // reset：重置\n    this.notify = function (type, info) {\n      if (type === 'setFieldValue' || type === 'innerSetValue' && !info.ignore) {\n        // type = reset时，在reset函数里处理\n        // if info.field is a[0], get a.0\n        _this._pushTouchField(info.changeValues ? iterativelyGetKeys(info.changeValues) : _this._getIterativelyKeysByField(info.field));\n      }\n      _this.registerFields.forEach(function (item) {\n        item.onStoreChange && item.onStoreChange(type, __assign(__assign({}, info), {\n          current: _this.store\n        }));\n      });\n    };\n    this.innerSetInitialValues = function (values) {\n      if (!values) return;\n      _this.initialValues = cloneDeep(values);\n      Object.keys(values).forEach(function (field) {\n        set(_this.store, field, values[field]);\n      });\n    };\n    this.innerSetInitialValue = function (field, value) {\n      if (!field) return;\n      _this.initialValues[field] = value;\n      // 组件在创建的时候，需要判断store里存的对应field的值是否生效。只要没有被操作过（touchedFields里不存在），就生效\n      if (!_this._inTouchFields(field)) {\n        set(_this.store, field, get(_this.initialValues, field));\n      }\n    };\n    /**\n     *\n     * 内部使用，更新value，会同时触发onChange 和 onValuesChange\n     * @options.isFormList  强制更新field对应的组件包括其子组件,form\n     */\n    this.innerSetFieldValue = function (field, value, options) {\n      var _a, _b, _c;\n      if (!field) return;\n      var prev = cloneDeep(_this.store);\n      set(_this.store, field, value);\n      _this.triggerValuesChange((_a = {}, _a[field] = value, _a));\n      _this.triggerTouchChange((_b = {}, _b[field] = value, _b));\n      _this.notify('innerSetValue', __assign(__assign({\n        prev: prev,\n        field: field\n      }, options), {\n        changeValues: (_c = {}, _c[field] = value, _c)\n      }));\n    };\n    // 内部使用\n    this.innerGetStore = function () {\n      return _this.store;\n    };\n    // 目前返回提交状态，后续统一维护 errors,warnings 后，这里可进行拓展\n    this.innerGetStoreStatus = function () {\n      return {\n        submitStatus: _this.submitStatus\n      };\n    };\n    // 内部使用，返回原始对象，注入到组件的 value 都从这里获取值，cloneDeep 后的值每次引用地址是不同的\n    this.innerGetFieldValue = function (field) {\n      return get(_this.store, field);\n    };\n    // 获取所有被操作过的字段\n    this.getTouchedFields = function () {\n      return _this.getRegisteredFields(true).filter(function (item) {\n        return item.isTouched();\n      }).map(function (x) {\n        return x.props.field;\n      });\n    };\n    // 外部调用设置表单字段值\n    this.setFieldValue = function (field, value) {\n      var _a;\n      if (!field) return;\n      _this.setFields((_a = {}, _a[field] = {\n        value: value\n      }, _a));\n    };\n    // 外部调用，设置多个表单控件的值\n    this.setFieldsValue = function (values) {\n      if (isObject(values)) {\n        var fields = Object.keys(values);\n        var obj_1 = {};\n        fields.forEach(function (field) {\n          obj_1[field] = {\n            value: values[field]\n          };\n        });\n        _this.setFields(obj_1);\n      }\n    };\n    // 外部调用，设置多个表单控件的值，以及 error，touch 信息。\n    this.setFields = function (obj) {\n      var fields = Object.keys(obj);\n      var changeValues = {};\n      fields.forEach(function (field) {\n        var _a;\n        var item = obj[field];\n        var prev = cloneDeep(_this.store);\n        if (item) {\n          var info = {};\n          if ('error' in item) {\n            info.errors = item.error;\n          }\n          if ('warning' in item) {\n            info.warnings = item.warning;\n          }\n          if ('touched' in item) {\n            info.touched = item.touched;\n          }\n          if ('value' in item) {\n            set(_this.store, field, item.value);\n            changeValues[field] = item.value;\n          }\n          _this.notify('setFieldValue', {\n            data: info,\n            prev: prev,\n            field: field,\n            changeValues: (_a = {}, _a[field] = item.value, _a)\n          });\n        }\n      });\n      _this.triggerValuesChange(changeValues);\n    };\n    this.getFieldValue = function (field) {\n      return cloneDeep(get(_this.store, field));\n    };\n    // 获取单个字段的错误信息。\n    this.getFieldError = function (field) {\n      var item = _this.getRegisteredField(field);\n      return item ? item.getErrors() : null;\n    };\n    // 获取传入字段/全部的错误信息\n    this.getFieldsError = function (fields) {\n      var errors = {};\n      if (isArray(fields)) {\n        fields.map(function (field) {\n          var error = _this.getFieldError(field);\n          if (error) {\n            errors[field] = error;\n          }\n        });\n      } else {\n        _this.getRegisteredFields(true, {\n          containFormList: true\n        }).forEach(function (item) {\n          if (item.getErrors()) {\n            errors[item.props.field] = item.getErrors();\n          }\n        });\n      }\n      return errors;\n    };\n    this.getFields = function () {\n      return cloneDeep(_this.store);\n    };\n    this.getFieldsValue = function (fields) {\n      var values = {};\n      if (isArray(fields)) {\n        fields.forEach(function (key) {\n          set(values, key, _this.getFieldValue(key));\n        });\n        return values;\n      }\n      _this.getRegisteredFields(true).forEach(function (_a) {\n        var field = _a.props.field;\n        var value = get(_this.store, field);\n        set(values, field, value);\n      });\n      return values;\n    };\n    this.resetFields = function (fieldKeys) {\n      var prev = cloneDeep(_this.store);\n      var fields = isExist(fieldKeys) && !isArray(fieldKeys) ? [fieldKeys] : fieldKeys;\n      if (fields && isArray(fields)) {\n        var changeValues_1 = {};\n        fields.forEach(function (field) {\n          set(_this.store, field, _this.initialValues[field]);\n          changeValues_1[field] = get(_this.store, field);\n        });\n        _this.triggerValuesChange(changeValues_1);\n        _this.notify('reset', {\n          prev: prev,\n          field: fields\n        });\n        _this._popTouchField(fields);\n      } else {\n        var newValues_1 = {};\n        var changeValues_2 = cloneDeep(_this.store);\n        Object.keys(_this.initialValues).forEach(function (field) {\n          set(newValues_1, field, _this.initialValues[field]);\n        });\n        _this.store = newValues_1;\n        _this.getRegisteredFields(true).forEach(function (item) {\n          var key = item.props.field;\n          set(changeValues_2, key, get(_this.store, key));\n        });\n        _this.triggerValuesChange(changeValues_2);\n        _this._popTouchField();\n        _this.notify('reset', {\n          prev: prev,\n          field: Object.keys(changeValues_2)\n        });\n      }\n    };\n    // 这坨代码好烂啊。。有时间一定重构 。。 一定。。 一定！！！\n    this.validate = promisify(function (fieldsOrCallbackOrConfig, cbOrConfig, cb) {\n      var allItems = _this.getRegisteredFields(true, {\n        containFormList: true\n      });\n      var controlItems = isArray(fieldsOrCallbackOrConfig) && fieldsOrCallbackOrConfig.length ? allItems.filter(function (x) {\n        return fieldsOrCallbackOrConfig.indexOf(x.props.field) > -1;\n      }) : allItems;\n      var options = isObject(fieldsOrCallbackOrConfig) ? fieldsOrCallbackOrConfig : isObject(cbOrConfig) ? cbOrConfig : {};\n      var callback = isFunction(fieldsOrCallbackOrConfig) ? fieldsOrCallbackOrConfig : isFunction(cbOrConfig) ? cbOrConfig : cb || function () {};\n      var promises = controlItems.map(function (x) {\n        return (options === null || options === void 0 ? void 0 : options.validateOnly) ? x.validateFieldOnly() : x.validateField();\n      });\n      var onValidateFail = function (errors) {\n        if (!(options === null || options === void 0 ? void 0 : options.validateOnly)) {\n          var onValidateFail_1 = _this.callbacks.onValidateFail;\n          onValidateFail_1 && onValidateFail_1(errors);\n        }\n      };\n      Promise.all(promises).then(function (result) {\n        var errors = {};\n        var values = {};\n        result.map(function (x) {\n          var _a;\n          if (x.error) {\n            errors = __assign(__assign({}, errors), x.error);\n          }\n          var item = _this.getRegisteredField(x.field);\n          if (!((_a = item === null || item === void 0 ? void 0 : item.props) === null || _a === void 0 ? void 0 : _a.isFormList)) {\n            // 保持和 2.46.0 之前版本行为一致，避免 {users: []}\n            set(values, x.field, x.value);\n          }\n        });\n        if (Object.keys(errors).length) {\n          onValidateFail(errors);\n          callback && callback(errors, cloneDeep(values));\n        } else {\n          callback && callback(null, cloneDeep(values));\n        }\n      });\n    });\n    this.toggleSubmitStatus = function (submitStatus) {\n      _this.submitStatus = submitStatus;\n      _this.innerCollectFormState();\n      _this.notifyFormWatcher();\n    };\n    this.submit = function () {\n      _this.toggleSubmitStatus(SubmitStatus.submitting);\n      _this.validate(function (errors, values) {\n        var result;\n        var _a = _this.callbacks,\n          onSubmit = _a.onSubmit,\n          onSubmitFailed = _a.onSubmitFailed;\n        if (!errors && onSubmit) {\n          result = onSubmit(values);\n        }\n        if (errors && onSubmitFailed) {\n          result = onSubmitFailed(errors);\n        }\n        if (result && result.then) {\n          // resolve 或者 reject， 都需要更新 submitting 的提交状态\n          result.then(function (data) {\n            _this.toggleSubmitStatus(SubmitStatus.success);\n            return data;\n          }).catch(function (error) {\n            // 保持以前的逻辑\n            _this.toggleSubmitStatus(SubmitStatus.error);\n            return Promise.reject(error);\n          });\n        } else {\n          _this.toggleSubmitStatus(errors ? SubmitStatus.error : SubmitStatus.success);\n        }\n      });\n    };\n    this.getFieldsState = function (fields) {\n      var result = {};\n      var getItemState = function (item) {\n        if (!item) {\n          return null;\n        }\n        var error = item.getErrors();\n        return {\n          errors: error ? [error] : [],\n          warnings: item.getWarnings(),\n          validateStatus: item.getValidateStatus(),\n          isSubmitting: _this.submitStatus === SubmitStatus.submitting,\n          isTouched: item.isTouched(),\n          value: _this.getFieldValue(item.props.field)\n        };\n      };\n      if (isArray(fields)) {\n        fields.forEach(function (key) {\n          result[key] = getItemState(_this.getRegisteredField(key));\n        });\n        return result;\n      }\n      _this.getRegisteredFields(true).forEach(function (item) {\n        result[item.props.field] = getItemState(item);\n      });\n      return result;\n    };\n    this.clearFields = function (fieldKeys) {\n      var prev = cloneDeep(_this.store);\n      var fields = isExist(fieldKeys) && !isArray(fieldKeys) ? [fieldKeys] : fieldKeys;\n      if (fields && isArray(fields)) {\n        var changeValues_3 = {};\n        fields.forEach(function (field) {\n          set(_this.store, field, undefined);\n          changeValues_3[field] = get(_this.store, field);\n        });\n        _this.triggerValuesChange(changeValues_3);\n        _this.notify('setFieldValue', {\n          prev: prev,\n          field: fields,\n          data: {\n            errors: null,\n            warnings: null\n          }\n        });\n        // this._popTouchField(fields);\n      } else {\n        var changeValues_4 = {};\n        _this.store = {};\n        _this.getRegisteredFields(true).forEach(function (item) {\n          var key = item.props.field;\n          set(changeValues_4, key, undefined);\n        });\n        _this.triggerValuesChange(changeValues_4);\n        // this._popTouchField();\n        _this.notify('setFieldValue', {\n          prev: prev,\n          field: Object.keys(changeValues_4),\n          data: {\n            errors: null,\n            warnings: null\n          }\n        });\n      }\n    };\n  }\n  Store.prototype.notifyWatchers = function () {\n    this.registerWatchers.forEach(function (item) {\n      item();\n    });\n  };\n  // 注册监听全局状态的 watcher\n  Store.prototype.notifyFormWatcher = function () {\n    this.registerFormWatchers.forEach(function (item) {\n      item();\n    });\n  };\n  Store.prototype.notifyStateWatchers = function () {\n    this.registerStateWatchers.forEach(function (item) {\n      item();\n    });\n  };\n  Store.prototype.triggerValuesChange = function (value) {\n    if (value && Object.keys(value).length) {\n      var onValuesChange = this.callbacks.onValuesChange;\n      onValuesChange && onValuesChange(value, this.getFields());\n    }\n    this.notifyWatchers();\n  };\n  Store.prototype.triggerTouchChange = function (value) {\n    if (value && Object.keys(value).length) {\n      var onChange = this.callbacks.onChange;\n      onChange && onChange(value, this.getFields());\n    }\n  };\n  Store.prototype._getIterativelyKeysByField = function (field) {\n    if (!field) {\n      return [];\n    }\n    var fields = [].concat(field);\n    var keys = fields.map(function (item) {\n      return iterativelyGetKeys(set({}, item, undefined));\n    }).reduce(function (total, next) {\n      return total.concat(next);\n    }, []);\n    return __spreadArray([field], __read(keys), false);\n  };\n  Store.prototype._inTouchFields = function (field) {\n    var _this = this;\n    var keys = this._getIterativelyKeysByField(field);\n    // return fields.some((item) => has(fieldObj, item));\n    return keys.some(function (item) {\n      return has(_this.touchedFields, item);\n    });\n  };\n  Store.prototype._popTouchField = function (field) {\n    if (field === undefined) {\n      this.touchedFields = {};\n    }\n    var keys = this._getIterativelyKeysByField(field);\n    this.touchedFields = omit(this.touchedFields, keys);\n  };\n  Store.prototype._pushTouchField = function (field) {\n    var _this = this;\n    [].concat(field).forEach(function (key) {\n      setWith(_this.touchedFields, key, undefined, Object);\n    });\n  };\n  return Store;\n}();\nexport default Store;","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__read","o","m","Symbol","iterator","r","ar","e","next","done","push","value","error","__spreadArray","to","from","pack","l","Array","slice","concat","get","setWith","has","omit","cloneDeep","set","iterativelyGetKeys","isArray","isFunction","isObject","isExist","SubmitStatus","promisify","Store","_this","submitStatus","init","registerFields","registerWatchers","registerStateWatchers","registerFormWatchers","touchedFields","store","initialValues","callbacks","innerCollectFormState","notifyStateWatchers","innerSetCallbacks","values","registerFormWatcher","item","filter","x","registerStateWatcher","registerWatcher","registerField","notifyWatchers","getRegisteredFields","hasField","options","control","_a","hasFieldProps","containFormList","props","isFormList","getRegisteredField","field","notify","type","info","ignore","_pushTouchField","changeValues","_getIterativelyKeysByField","forEach","onStoreChange","current","innerSetInitialValues","keys","innerSetInitialValue","_inTouchFields","innerSetFieldValue","_b","_c","prev","triggerValuesChange","triggerTouchChange","innerGetStore","innerGetStoreStatus","innerGetFieldValue","getTouchedFields","isTouched","map","setFieldValue","setFields","setFieldsValue","fields","obj_1","obj","errors","warnings","warning","touched","data","getFieldValue","getFieldError","getErrors","getFieldsError","getFields","getFieldsValue","key","resetFields","fieldKeys","changeValues_1","_popTouchField","newValues_1","changeValues_2","validate","fieldsOrCallbackOrConfig","cbOrConfig","cb","allItems","controlItems","indexOf","callback","promises","validateOnly","validateFieldOnly","validateField","onValidateFail","onValidateFail_1","Promise","all","then","result","toggleSubmitStatus","notifyFormWatcher","submit","submitting","onSubmit","onSubmitFailed","success","catch","reject","getFieldsState","getItemState","getWarnings","validateStatus","getValidateStatus","isSubmitting","clearFields","changeValues_3","undefined","changeValues_4","onValuesChange","onChange","reduce","total","some"],"sources":["D:/Nodejs/oj-frontend/node_modules/@arco-design/web-react/es/Form/store.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport get from 'lodash/get';\nimport setWith from 'lodash/setWith';\nimport has from 'lodash/has';\nimport omit from 'lodash/omit';\nimport { cloneDeep, set, iterativelyGetKeys } from './utils';\nimport { isArray, isFunction, isObject, isExist } from '../_util/is';\nimport { SubmitStatus, } from './interface';\nimport promisify from './promisify';\nvar Store = /** @class */ (function () {\n    function Store() {\n        var _this = this;\n        // 表示的 Form 的提交状态而非单个字段的提交状态。\n        // 只有在触发表单 reset（原生 reset，而非当前的 resetFields） 时，才会回到  init 状态（目前没有支持 form.reset，所以没有这块逻辑）\n        this.submitStatus = SubmitStatus.init;\n        this.registerFields = [];\n        // 所有 form item value 的变动，都会通知这里注册到的 watcher\n        this.registerWatchers = [];\n        // 所有 form item 内部 errors, validating, touched 状态的变化，都会通知这里注册到的 watcher\n        // TODO: 合并 registerWatchers\n        this.registerStateWatchers = [];\n        // 所有 form 整体 的变动，都会通知这里注册到的 watcher\n        this.registerFormWatchers = [];\n        // 和formControl 的 touched属性不一样。 只要被改过的字段，这里就会存储。并且不会跟随formControl被卸载而清除。\n        // reset 的时候清除\n        this.touchedFields = {};\n        this.store = {};\n        this.initialValues = {};\n        this.callbacks = {};\n        // 告知 form 状态改变，进行状态收集\n        this.innerCollectFormState = function () {\n            _this.notifyStateWatchers();\n        };\n        this.innerSetCallbacks = function (values) {\n            _this.callbacks = values;\n        };\n        this.registerFormWatcher = function (item) {\n            _this.registerFormWatchers.push(item);\n            return function () {\n                _this.registerFormWatchers = _this.registerFormWatchers.filter(function (x) { return x !== item; });\n            };\n        };\n        this.registerStateWatcher = function (item) {\n            _this.registerStateWatchers.push(item);\n            return function () {\n                _this.registerStateWatchers = _this.registerStateWatchers.filter(function (x) { return x !== item; });\n            };\n        };\n        this.registerWatcher = function (item) {\n            _this.registerWatchers.push(item);\n            return function () {\n                _this.registerWatchers = _this.registerWatchers.filter(function (x) { return x !== item; });\n            };\n        };\n        // 收集所有control字段，并在组件卸载时移除\n        this.registerField = function (item) {\n            _this.registerFields.push(item);\n            _this.notifyWatchers();\n            return function () {\n                _this.registerFields = _this.registerFields.filter(function (x) { return x !== item; });\n                _this.notifyWatchers();\n            };\n        };\n        // hasField为true时，只返回传入field属性的control实例\n        // isFormList 目前只在校验时需要包含\n        // TODO formlist 实现缺陷，待优化\n        this.getRegisteredFields = function (hasField, options) {\n            if (hasField) {\n                return _this.registerFields.filter(function (control) { var _a; return control.hasFieldProps() && ((options === null || options === void 0 ? void 0 : options.containFormList) || !((_a = control.props) === null || _a === void 0 ? void 0 : _a.isFormList)); });\n            }\n            return _this.registerFields;\n        };\n        // 获取props.field === field 的control组件。\n        this.getRegisteredField = function (field) {\n            return _this.registerFields.filter(function (x) { return x.props.field === field; })[0];\n        };\n        // 通知所有的FormItem进行更新。\n        // setFieldValue: 外部调用setFieldsValue (setFieldValue等)方法触发更新\n        // innerSetValue: 控件例如Input，通过onChange事件触发的更新\n        // reset：重置\n        this.notify = function (type, info) {\n            if (type === 'setFieldValue' || (type === 'innerSetValue' && !info.ignore)) {\n                // type = reset时，在reset函数里处理\n                // if info.field is a[0], get a.0\n                _this._pushTouchField(info.changeValues\n                    ? iterativelyGetKeys(info.changeValues)\n                    : _this._getIterativelyKeysByField(info.field));\n            }\n            _this.registerFields.forEach(function (item) {\n                item.onStoreChange &&\n                    item.onStoreChange(type, __assign(__assign({}, info), { current: _this.store }));\n            });\n        };\n        this.innerSetInitialValues = function (values) {\n            if (!values)\n                return;\n            _this.initialValues = cloneDeep(values);\n            Object.keys(values).forEach(function (field) {\n                set(_this.store, field, values[field]);\n            });\n        };\n        this.innerSetInitialValue = function (field, value) {\n            if (!field)\n                return;\n            _this.initialValues[field] = value;\n            // 组件在创建的时候，需要判断store里存的对应field的值是否生效。只要没有被操作过（touchedFields里不存在），就生效\n            if (!_this._inTouchFields(field)) {\n                set(_this.store, field, get(_this.initialValues, field));\n            }\n        };\n        /**\n         *\n         * 内部使用，更新value，会同时触发onChange 和 onValuesChange\n         * @options.isFormList  强制更新field对应的组件包括其子组件,form\n         */\n        this.innerSetFieldValue = function (field, value, options) {\n            var _a, _b, _c;\n            if (!field)\n                return;\n            var prev = cloneDeep(_this.store);\n            set(_this.store, field, value);\n            _this.triggerValuesChange((_a = {}, _a[field] = value, _a));\n            _this.triggerTouchChange((_b = {}, _b[field] = value, _b));\n            _this.notify('innerSetValue', __assign(__assign({ prev: prev, field: field }, options), { changeValues: (_c = {}, _c[field] = value, _c) }));\n        };\n        // 内部使用\n        this.innerGetStore = function () {\n            return _this.store;\n        };\n        // 目前返回提交状态，后续统一维护 errors,warnings 后，这里可进行拓展\n        this.innerGetStoreStatus = function () {\n            return {\n                submitStatus: _this.submitStatus,\n            };\n        };\n        // 内部使用，返回原始对象，注入到组件的 value 都从这里获取值，cloneDeep 后的值每次引用地址是不同的\n        this.innerGetFieldValue = function (field) {\n            return get(_this.store, field);\n        };\n        // 获取所有被操作过的字段\n        this.getTouchedFields = function () {\n            return _this.getRegisteredFields(true)\n                .filter(function (item) {\n                return item.isTouched();\n            })\n                .map(function (x) { return x.props.field; });\n        };\n        // 外部调用设置表单字段值\n        this.setFieldValue = function (field, value) {\n            var _a;\n            if (!field)\n                return;\n            _this.setFields((_a = {},\n                _a[field] = { value: value },\n                _a));\n        };\n        // 外部调用，设置多个表单控件的值\n        this.setFieldsValue = function (values) {\n            if (isObject(values)) {\n                var fields = Object.keys(values);\n                var obj_1 = {};\n                fields.forEach(function (field) {\n                    obj_1[field] = {\n                        value: values[field],\n                    };\n                });\n                _this.setFields(obj_1);\n            }\n        };\n        // 外部调用，设置多个表单控件的值，以及 error，touch 信息。\n        this.setFields = function (obj) {\n            var fields = Object.keys(obj);\n            var changeValues = {};\n            fields.forEach(function (field) {\n                var _a;\n                var item = obj[field];\n                var prev = cloneDeep(_this.store);\n                if (item) {\n                    var info = {};\n                    if ('error' in item) {\n                        info.errors = item.error;\n                    }\n                    if ('warning' in item) {\n                        info.warnings = item.warning;\n                    }\n                    if ('touched' in item) {\n                        info.touched = item.touched;\n                    }\n                    if ('value' in item) {\n                        set(_this.store, field, item.value);\n                        changeValues[field] = item.value;\n                    }\n                    _this.notify('setFieldValue', {\n                        data: info,\n                        prev: prev,\n                        field: field,\n                        changeValues: (_a = {}, _a[field] = item.value, _a),\n                    });\n                }\n            });\n            _this.triggerValuesChange(changeValues);\n        };\n        this.getFieldValue = function (field) {\n            return cloneDeep(get(_this.store, field));\n        };\n        // 获取单个字段的错误信息。\n        this.getFieldError = function (field) {\n            var item = _this.getRegisteredField(field);\n            return item ? item.getErrors() : null;\n        };\n        // 获取传入字段/全部的错误信息\n        this.getFieldsError = function (fields) {\n            var errors = {};\n            if (isArray(fields)) {\n                fields.map(function (field) {\n                    var error = _this.getFieldError(field);\n                    if (error) {\n                        errors[field] = error;\n                    }\n                });\n            }\n            else {\n                _this.getRegisteredFields(true, { containFormList: true }).forEach(function (item) {\n                    if (item.getErrors()) {\n                        errors[item.props.field] = item.getErrors();\n                    }\n                });\n            }\n            return errors;\n        };\n        this.getFields = function () {\n            return cloneDeep(_this.store);\n        };\n        this.getFieldsValue = function (fields) {\n            var values = {};\n            if (isArray(fields)) {\n                fields.forEach(function (key) {\n                    set(values, key, _this.getFieldValue(key));\n                });\n                return values;\n            }\n            _this.getRegisteredFields(true).forEach(function (_a) {\n                var field = _a.props.field;\n                var value = get(_this.store, field);\n                set(values, field, value);\n            });\n            return values;\n        };\n        this.resetFields = function (fieldKeys) {\n            var prev = cloneDeep(_this.store);\n            var fields = isExist(fieldKeys) && !isArray(fieldKeys) ? [fieldKeys] : fieldKeys;\n            if (fields && isArray(fields)) {\n                var changeValues_1 = {};\n                fields.forEach(function (field) {\n                    set(_this.store, field, _this.initialValues[field]);\n                    changeValues_1[field] = get(_this.store, field);\n                });\n                _this.triggerValuesChange(changeValues_1);\n                _this.notify('reset', { prev: prev, field: fields });\n                _this._popTouchField(fields);\n            }\n            else {\n                var newValues_1 = {};\n                var changeValues_2 = cloneDeep(_this.store);\n                Object.keys(_this.initialValues).forEach(function (field) {\n                    set(newValues_1, field, _this.initialValues[field]);\n                });\n                _this.store = newValues_1;\n                _this.getRegisteredFields(true).forEach(function (item) {\n                    var key = item.props.field;\n                    set(changeValues_2, key, get(_this.store, key));\n                });\n                _this.triggerValuesChange(changeValues_2);\n                _this._popTouchField();\n                _this.notify('reset', { prev: prev, field: Object.keys(changeValues_2) });\n            }\n        };\n        // 这坨代码好烂啊。。有时间一定重构 。。 一定。。 一定！！！\n        this.validate = promisify(function (fieldsOrCallbackOrConfig, cbOrConfig, cb) {\n            var allItems = _this.getRegisteredFields(true, {\n                containFormList: true,\n            });\n            var controlItems = isArray(fieldsOrCallbackOrConfig) && fieldsOrCallbackOrConfig.length\n                ? allItems.filter(function (x) { return fieldsOrCallbackOrConfig.indexOf(x.props.field) > -1; })\n                : allItems;\n            var options = isObject(fieldsOrCallbackOrConfig)\n                ? fieldsOrCallbackOrConfig\n                : isObject(cbOrConfig)\n                    ? cbOrConfig\n                    : {};\n            var callback = isFunction(fieldsOrCallbackOrConfig)\n                ? fieldsOrCallbackOrConfig\n                : isFunction(cbOrConfig)\n                    ? cbOrConfig\n                    : cb || (function () { });\n            var promises = controlItems.map(function (x) {\n                return (options === null || options === void 0 ? void 0 : options.validateOnly) ? x.validateFieldOnly() : x.validateField();\n            });\n            var onValidateFail = function (errors) {\n                if (!(options === null || options === void 0 ? void 0 : options.validateOnly)) {\n                    var onValidateFail_1 = _this.callbacks.onValidateFail;\n                    onValidateFail_1 && onValidateFail_1(errors);\n                }\n            };\n            Promise.all(promises).then(function (result) {\n                var errors = {};\n                var values = {};\n                result.map(function (x) {\n                    var _a;\n                    if (x.error) {\n                        errors = __assign(__assign({}, errors), x.error);\n                    }\n                    var item = _this.getRegisteredField(x.field);\n                    if (!((_a = item === null || item === void 0 ? void 0 : item.props) === null || _a === void 0 ? void 0 : _a.isFormList)) {\n                        // 保持和 2.46.0 之前版本行为一致，避免 {users: []}\n                        set(values, x.field, x.value);\n                    }\n                });\n                if (Object.keys(errors).length) {\n                    onValidateFail(errors);\n                    callback && callback(errors, cloneDeep(values));\n                }\n                else {\n                    callback && callback(null, cloneDeep(values));\n                }\n            });\n        });\n        this.toggleSubmitStatus = function (submitStatus) {\n            _this.submitStatus = submitStatus;\n            _this.innerCollectFormState();\n            _this.notifyFormWatcher();\n        };\n        this.submit = function () {\n            _this.toggleSubmitStatus(SubmitStatus.submitting);\n            _this.validate(function (errors, values) {\n                var result;\n                var _a = _this.callbacks, onSubmit = _a.onSubmit, onSubmitFailed = _a.onSubmitFailed;\n                if (!errors && onSubmit) {\n                    result = onSubmit(values);\n                }\n                if (errors && onSubmitFailed) {\n                    result = onSubmitFailed(errors);\n                }\n                if (result && result.then) {\n                    // resolve 或者 reject， 都需要更新 submitting 的提交状态\n                    result\n                        .then(function (data) {\n                        _this.toggleSubmitStatus(SubmitStatus.success);\n                        return data;\n                    })\n                        .catch(function (error) {\n                        // 保持以前的逻辑\n                        _this.toggleSubmitStatus(SubmitStatus.error);\n                        return Promise.reject(error);\n                    });\n                }\n                else {\n                    _this.toggleSubmitStatus(errors ? SubmitStatus.error : SubmitStatus.success);\n                }\n            });\n        };\n        this.getFieldsState = function (fields) {\n            var result = {};\n            var getItemState = function (item) {\n                if (!item) {\n                    return null;\n                }\n                var error = item.getErrors();\n                return {\n                    errors: error ? [error] : [],\n                    warnings: item.getWarnings(),\n                    validateStatus: item.getValidateStatus(),\n                    isSubmitting: _this.submitStatus === SubmitStatus.submitting,\n                    isTouched: item.isTouched(),\n                    value: _this.getFieldValue(item.props.field),\n                };\n            };\n            if (isArray(fields)) {\n                fields.forEach(function (key) {\n                    result[key] = getItemState(_this.getRegisteredField(key));\n                });\n                return result;\n            }\n            _this.getRegisteredFields(true).forEach(function (item) {\n                result[item.props.field] = getItemState(item);\n            });\n            return result;\n        };\n        this.clearFields = function (fieldKeys) {\n            var prev = cloneDeep(_this.store);\n            var fields = isExist(fieldKeys) && !isArray(fieldKeys) ? [fieldKeys] : fieldKeys;\n            if (fields && isArray(fields)) {\n                var changeValues_3 = {};\n                fields.forEach(function (field) {\n                    set(_this.store, field, undefined);\n                    changeValues_3[field] = get(_this.store, field);\n                });\n                _this.triggerValuesChange(changeValues_3);\n                _this.notify('setFieldValue', {\n                    prev: prev,\n                    field: fields,\n                    data: {\n                        errors: null,\n                        warnings: null,\n                    },\n                });\n                // this._popTouchField(fields);\n            }\n            else {\n                var changeValues_4 = {};\n                _this.store = {};\n                _this.getRegisteredFields(true).forEach(function (item) {\n                    var key = item.props.field;\n                    set(changeValues_4, key, undefined);\n                });\n                _this.triggerValuesChange(changeValues_4);\n                // this._popTouchField();\n                _this.notify('setFieldValue', {\n                    prev: prev,\n                    field: Object.keys(changeValues_4),\n                    data: {\n                        errors: null,\n                        warnings: null,\n                    },\n                });\n            }\n        };\n    }\n    Store.prototype.notifyWatchers = function () {\n        this.registerWatchers.forEach(function (item) {\n            item();\n        });\n    };\n    // 注册监听全局状态的 watcher\n    Store.prototype.notifyFormWatcher = function () {\n        this.registerFormWatchers.forEach(function (item) {\n            item();\n        });\n    };\n    Store.prototype.notifyStateWatchers = function () {\n        this.registerStateWatchers.forEach(function (item) {\n            item();\n        });\n    };\n    Store.prototype.triggerValuesChange = function (value) {\n        if (value && Object.keys(value).length) {\n            var onValuesChange = this.callbacks.onValuesChange;\n            onValuesChange && onValuesChange(value, this.getFields());\n        }\n        this.notifyWatchers();\n    };\n    Store.prototype.triggerTouchChange = function (value) {\n        if (value && Object.keys(value).length) {\n            var onChange = this.callbacks.onChange;\n            onChange && onChange(value, this.getFields());\n        }\n    };\n    Store.prototype._getIterativelyKeysByField = function (field) {\n        if (!field) {\n            return [];\n        }\n        var fields = [].concat(field);\n        var keys = fields\n            .map(function (item) { return iterativelyGetKeys(set({}, item, undefined)); })\n            .reduce(function (total, next) {\n            return total.concat(next);\n        }, []);\n        return __spreadArray([field], __read(keys), false);\n    };\n    Store.prototype._inTouchFields = function (field) {\n        var _this = this;\n        var keys = this._getIterativelyKeysByField(field);\n        // return fields.some((item) => has(fieldObj, item));\n        return keys.some(function (item) { return has(_this.touchedFields, item); });\n    };\n    Store.prototype._popTouchField = function (field) {\n        if (field === undefined) {\n            this.touchedFields = {};\n        }\n        var keys = this._getIterativelyKeysByField(field);\n        this.touchedFields = omit(this.touchedFields, keys);\n    };\n    Store.prototype._pushTouchField = function (field) {\n        var _this = this;\n        [].concat(field).forEach(function (key) {\n            setWith(_this.touchedFields, key, undefined, Object);\n        });\n    };\n    return Store;\n}());\nexport default Store;\n"],"mappings":";;;;;;;AAAA,IAAIA,QAAQ,GAAI,IAAI,IAAI,IAAI,CAACA,QAAQ,IAAK,YAAY;EAClDA,QAAQ,GAAGC,MAAM,CAACC,MAAM,IAAI,UAASC,CAAC,EAAE;IACpC,KAAK,IAAIC,CAAC,EAAEC,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEH,CAAC,GAAGC,CAAC,EAAED,CAAC,EAAE,EAAE;MACjDD,CAAC,GAAGG,SAAS,CAACF,CAAC,CAAC;MAChB,KAAK,IAAII,CAAC,IAAIL,CAAC,EAAE,IAAIH,MAAM,CAACS,SAAS,CAACC,cAAc,CAACC,IAAI,CAACR,CAAC,EAAEK,CAAC,CAAC,EAC3DN,CAAC,CAACM,CAAC,CAAC,GAAGL,CAAC,CAACK,CAAC,CAAC;IACnB;IACA,OAAON,CAAC;EACZ,CAAC;EACD,OAAOH,QAAQ,CAACa,KAAK,CAAC,IAAI,EAAEN,SAAS,CAAC;AAC1C,CAAC;AACD,IAAIO,MAAM,GAAI,IAAI,IAAI,IAAI,CAACA,MAAM,IAAK,UAAUC,CAAC,EAAET,CAAC,EAAE;EAClD,IAAIU,CAAC,GAAG,OAAOC,MAAM,KAAK,UAAU,IAAIF,CAAC,CAACE,MAAM,CAACC,QAAQ,CAAC;EAC1D,IAAI,CAACF,CAAC,EAAE,OAAOD,CAAC;EAChB,IAAIV,CAAC,GAAGW,CAAC,CAACJ,IAAI,CAACG,CAAC,CAAC;IAAEI,CAAC;IAAEC,EAAE,GAAG,EAAE;IAAEC,CAAC;EAChC,IAAI;IACA,OAAO,CAACf,CAAC,KAAK,KAAK,CAAC,IAAIA,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAACa,CAAC,GAAGd,CAAC,CAACiB,IAAI,CAAC,CAAC,EAAEC,IAAI,EAAEH,EAAE,CAACI,IAAI,CAACL,CAAC,CAACM,KAAK,CAAC;EAC9E,CAAC,CACD,OAAOC,KAAK,EAAE;IAAEL,CAAC,GAAG;MAAEK,KAAK,EAAEA;IAAM,CAAC;EAAE,CAAC,SAC/B;IACJ,IAAI;MACA,IAAIP,CAAC,IAAI,CAACA,CAAC,CAACI,IAAI,KAAKP,CAAC,GAAGX,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAEW,CAAC,CAACJ,IAAI,CAACP,CAAC,CAAC;IACpD,CAAC,SACO;MAAE,IAAIgB,CAAC,EAAE,MAAMA,CAAC,CAACK,KAAK;IAAE;EACpC;EACA,OAAON,EAAE;AACb,CAAC;AACD,IAAIO,aAAa,GAAI,IAAI,IAAI,IAAI,CAACA,aAAa,IAAK,UAAUC,EAAE,EAAEC,IAAI,EAAEC,IAAI,EAAE;EAC1E,IAAIA,IAAI,IAAIvB,SAAS,CAACC,MAAM,KAAK,CAAC,EAAE,KAAK,IAAIH,CAAC,GAAG,CAAC,EAAE0B,CAAC,GAAGF,IAAI,CAACrB,MAAM,EAAEY,EAAE,EAAEf,CAAC,GAAG0B,CAAC,EAAE1B,CAAC,EAAE,EAAE;IACjF,IAAIe,EAAE,IAAI,EAAEf,CAAC,IAAIwB,IAAI,CAAC,EAAE;MACpB,IAAI,CAACT,EAAE,EAAEA,EAAE,GAAGY,KAAK,CAACtB,SAAS,CAACuB,KAAK,CAACrB,IAAI,CAACiB,IAAI,EAAE,CAAC,EAAExB,CAAC,CAAC;MACpDe,EAAE,CAACf,CAAC,CAAC,GAAGwB,IAAI,CAACxB,CAAC,CAAC;IACnB;EACJ;EACA,OAAOuB,EAAE,CAACM,MAAM,CAACd,EAAE,IAAIY,KAAK,CAACtB,SAAS,CAACuB,KAAK,CAACrB,IAAI,CAACiB,IAAI,CAAC,CAAC;AAC5D,CAAC;AACD,OAAOM,GAAG,MAAM,YAAY;AAC5B,OAAOC,OAAO,MAAM,gBAAgB;AACpC,OAAOC,GAAG,MAAM,YAAY;AAC5B,OAAOC,IAAI,MAAM,aAAa;AAC9B,SAASC,SAAS,EAAEC,GAAG,EAAEC,kBAAkB,QAAQ,SAAS;AAC5D,SAASC,OAAO,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,aAAa;AACpE,SAASC,YAAY,QAAS,aAAa;AAC3C,OAAOC,SAAS,MAAM,aAAa;AACnC,IAAIC,KAAK,GAAG,aAAe,YAAY;EACnC,SAASA,KAAKA,CAAA,EAAG;IACb,IAAIC,KAAK,GAAG,IAAI;IAChB;IACA;IACA,IAAI,CAACC,YAAY,GAAGJ,YAAY,CAACK,IAAI;IACrC,IAAI,CAACC,cAAc,GAAG,EAAE;IACxB;IACA,IAAI,CAACC,gBAAgB,GAAG,EAAE;IAC1B;IACA;IACA,IAAI,CAACC,qBAAqB,GAAG,EAAE;IAC/B;IACA,IAAI,CAACC,oBAAoB,GAAG,EAAE;IAC9B;IACA;IACA,IAAI,CAACC,aAAa,GAAG,CAAC,CAAC;IACvB,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC;IACf,IAAI,CAACC,aAAa,GAAG,CAAC,CAAC;IACvB,IAAI,CAACC,SAAS,GAAG,CAAC,CAAC;IACnB;IACA,IAAI,CAACC,qBAAqB,GAAG,YAAY;MACrCX,KAAK,CAACY,mBAAmB,CAAC,CAAC;IAC/B,CAAC;IACD,IAAI,CAACC,iBAAiB,GAAG,UAAUC,MAAM,EAAE;MACvCd,KAAK,CAACU,SAAS,GAAGI,MAAM;IAC5B,CAAC;IACD,IAAI,CAACC,mBAAmB,GAAG,UAAUC,IAAI,EAAE;MACvChB,KAAK,CAACM,oBAAoB,CAAC/B,IAAI,CAACyC,IAAI,CAAC;MACrC,OAAO,YAAY;QACfhB,KAAK,CAACM,oBAAoB,GAAGN,KAAK,CAACM,oBAAoB,CAACW,MAAM,CAAC,UAAUC,CAAC,EAAE;UAAE,OAAOA,CAAC,KAAKF,IAAI;QAAE,CAAC,CAAC;MACvG,CAAC;IACL,CAAC;IACD,IAAI,CAACG,oBAAoB,GAAG,UAAUH,IAAI,EAAE;MACxChB,KAAK,CAACK,qBAAqB,CAAC9B,IAAI,CAACyC,IAAI,CAAC;MACtC,OAAO,YAAY;QACfhB,KAAK,CAACK,qBAAqB,GAAGL,KAAK,CAACK,qBAAqB,CAACY,MAAM,CAAC,UAAUC,CAAC,EAAE;UAAE,OAAOA,CAAC,KAAKF,IAAI;QAAE,CAAC,CAAC;MACzG,CAAC;IACL,CAAC;IACD,IAAI,CAACI,eAAe,GAAG,UAAUJ,IAAI,EAAE;MACnChB,KAAK,CAACI,gBAAgB,CAAC7B,IAAI,CAACyC,IAAI,CAAC;MACjC,OAAO,YAAY;QACfhB,KAAK,CAACI,gBAAgB,GAAGJ,KAAK,CAACI,gBAAgB,CAACa,MAAM,CAAC,UAAUC,CAAC,EAAE;UAAE,OAAOA,CAAC,KAAKF,IAAI;QAAE,CAAC,CAAC;MAC/F,CAAC;IACL,CAAC;IACD;IACA,IAAI,CAACK,aAAa,GAAG,UAAUL,IAAI,EAAE;MACjChB,KAAK,CAACG,cAAc,CAAC5B,IAAI,CAACyC,IAAI,CAAC;MAC/BhB,KAAK,CAACsB,cAAc,CAAC,CAAC;MACtB,OAAO,YAAY;QACftB,KAAK,CAACG,cAAc,GAAGH,KAAK,CAACG,cAAc,CAACc,MAAM,CAAC,UAAUC,CAAC,EAAE;UAAE,OAAOA,CAAC,KAAKF,IAAI;QAAE,CAAC,CAAC;QACvFhB,KAAK,CAACsB,cAAc,CAAC,CAAC;MAC1B,CAAC;IACL,CAAC;IACD;IACA;IACA;IACA,IAAI,CAACC,mBAAmB,GAAG,UAAUC,QAAQ,EAAEC,OAAO,EAAE;MACpD,IAAID,QAAQ,EAAE;QACV,OAAOxB,KAAK,CAACG,cAAc,CAACc,MAAM,CAAC,UAAUS,OAAO,EAAE;UAAE,IAAIC,EAAE;UAAE,OAAOD,OAAO,CAACE,aAAa,CAAC,CAAC,KAAK,CAACH,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACI,eAAe,KAAK,EAAE,CAACF,EAAE,GAAGD,OAAO,CAACI,KAAK,MAAM,IAAI,IAAIH,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACI,UAAU,CAAC,CAAC;QAAE,CAAC,CAAC;MACrQ;MACA,OAAO/B,KAAK,CAACG,cAAc;IAC/B,CAAC;IACD;IACA,IAAI,CAAC6B,kBAAkB,GAAG,UAAUC,KAAK,EAAE;MACvC,OAAOjC,KAAK,CAACG,cAAc,CAACc,MAAM,CAAC,UAAUC,CAAC,EAAE;QAAE,OAAOA,CAAC,CAACY,KAAK,CAACG,KAAK,KAAKA,KAAK;MAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3F,CAAC;IACD;IACA;IACA;IACA;IACA,IAAI,CAACC,MAAM,GAAG,UAAUC,IAAI,EAAEC,IAAI,EAAE;MAChC,IAAID,IAAI,KAAK,eAAe,IAAKA,IAAI,KAAK,eAAe,IAAI,CAACC,IAAI,CAACC,MAAO,EAAE;QACxE;QACA;QACArC,KAAK,CAACsC,eAAe,CAACF,IAAI,CAACG,YAAY,GACjC/C,kBAAkB,CAAC4C,IAAI,CAACG,YAAY,CAAC,GACrCvC,KAAK,CAACwC,0BAA0B,CAACJ,IAAI,CAACH,KAAK,CAAC,CAAC;MACvD;MACAjC,KAAK,CAACG,cAAc,CAACsC,OAAO,CAAC,UAAUzB,IAAI,EAAE;QACzCA,IAAI,CAAC0B,aAAa,IACd1B,IAAI,CAAC0B,aAAa,CAACP,IAAI,EAAEpF,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEqF,IAAI,CAAC,EAAE;UAAEO,OAAO,EAAE3C,KAAK,CAACQ;QAAM,CAAC,CAAC,CAAC;MACxF,CAAC,CAAC;IACN,CAAC;IACD,IAAI,CAACoC,qBAAqB,GAAG,UAAU9B,MAAM,EAAE;MAC3C,IAAI,CAACA,MAAM,EACP;MACJd,KAAK,CAACS,aAAa,GAAGnB,SAAS,CAACwB,MAAM,CAAC;MACvC9D,MAAM,CAAC6F,IAAI,CAAC/B,MAAM,CAAC,CAAC2B,OAAO,CAAC,UAAUR,KAAK,EAAE;QACzC1C,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAEnB,MAAM,CAACmB,KAAK,CAAC,CAAC;MAC1C,CAAC,CAAC;IACN,CAAC;IACD,IAAI,CAACa,oBAAoB,GAAG,UAAUb,KAAK,EAAEzD,KAAK,EAAE;MAChD,IAAI,CAACyD,KAAK,EACN;MACJjC,KAAK,CAACS,aAAa,CAACwB,KAAK,CAAC,GAAGzD,KAAK;MAClC;MACA,IAAI,CAACwB,KAAK,CAAC+C,cAAc,CAACd,KAAK,CAAC,EAAE;QAC9B1C,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAE/C,GAAG,CAACc,KAAK,CAACS,aAAa,EAAEwB,KAAK,CAAC,CAAC;MAC5D;IACJ,CAAC;IACD;AACR;AACA;AACA;AACA;IACQ,IAAI,CAACe,kBAAkB,GAAG,UAAUf,KAAK,EAAEzD,KAAK,EAAEiD,OAAO,EAAE;MACvD,IAAIE,EAAE,EAAEsB,EAAE,EAAEC,EAAE;MACd,IAAI,CAACjB,KAAK,EACN;MACJ,IAAIkB,IAAI,GAAG7D,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;MACjCjB,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAEzD,KAAK,CAAC;MAC9BwB,KAAK,CAACoD,mBAAmB,EAAEzB,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAACM,KAAK,CAAC,GAAGzD,KAAK,EAAEmD,EAAE,CAAC,CAAC;MAC3D3B,KAAK,CAACqD,kBAAkB,EAAEJ,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAAChB,KAAK,CAAC,GAAGzD,KAAK,EAAEyE,EAAE,CAAC,CAAC;MAC1DjD,KAAK,CAACkC,MAAM,CAAC,eAAe,EAAEnF,QAAQ,CAACA,QAAQ,CAAC;QAAEoG,IAAI,EAAEA,IAAI;QAAElB,KAAK,EAAEA;MAAM,CAAC,EAAER,OAAO,CAAC,EAAE;QAAEc,YAAY,GAAGW,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAACjB,KAAK,CAAC,GAAGzD,KAAK,EAAE0E,EAAE;MAAE,CAAC,CAAC,CAAC;IAChJ,CAAC;IACD;IACA,IAAI,CAACI,aAAa,GAAG,YAAY;MAC7B,OAAOtD,KAAK,CAACQ,KAAK;IACtB,CAAC;IACD;IACA,IAAI,CAAC+C,mBAAmB,GAAG,YAAY;MACnC,OAAO;QACHtD,YAAY,EAAED,KAAK,CAACC;MACxB,CAAC;IACL,CAAC;IACD;IACA,IAAI,CAACuD,kBAAkB,GAAG,UAAUvB,KAAK,EAAE;MACvC,OAAO/C,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEyB,KAAK,CAAC;IAClC,CAAC;IACD;IACA,IAAI,CAACwB,gBAAgB,GAAG,YAAY;MAChC,OAAOzD,KAAK,CAACuB,mBAAmB,CAAC,IAAI,CAAC,CACjCN,MAAM,CAAC,UAAUD,IAAI,EAAE;QACxB,OAAOA,IAAI,CAAC0C,SAAS,CAAC,CAAC;MAC3B,CAAC,CAAC,CACGC,GAAG,CAAC,UAAUzC,CAAC,EAAE;QAAE,OAAOA,CAAC,CAACY,KAAK,CAACG,KAAK;MAAE,CAAC,CAAC;IACpD,CAAC;IACD;IACA,IAAI,CAAC2B,aAAa,GAAG,UAAU3B,KAAK,EAAEzD,KAAK,EAAE;MACzC,IAAImD,EAAE;MACN,IAAI,CAACM,KAAK,EACN;MACJjC,KAAK,CAAC6D,SAAS,EAAElC,EAAE,GAAG,CAAC,CAAC,EACpBA,EAAE,CAACM,KAAK,CAAC,GAAG;QAAEzD,KAAK,EAAEA;MAAM,CAAC,EAC5BmD,EAAE,CAAC,CAAC;IACZ,CAAC;IACD;IACA,IAAI,CAACmC,cAAc,GAAG,UAAUhD,MAAM,EAAE;MACpC,IAAInB,QAAQ,CAACmB,MAAM,CAAC,EAAE;QAClB,IAAIiD,MAAM,GAAG/G,MAAM,CAAC6F,IAAI,CAAC/B,MAAM,CAAC;QAChC,IAAIkD,KAAK,GAAG,CAAC,CAAC;QACdD,MAAM,CAACtB,OAAO,CAAC,UAAUR,KAAK,EAAE;UAC5B+B,KAAK,CAAC/B,KAAK,CAAC,GAAG;YACXzD,KAAK,EAAEsC,MAAM,CAACmB,KAAK;UACvB,CAAC;QACL,CAAC,CAAC;QACFjC,KAAK,CAAC6D,SAAS,CAACG,KAAK,CAAC;MAC1B;IACJ,CAAC;IACD;IACA,IAAI,CAACH,SAAS,GAAG,UAAUI,GAAG,EAAE;MAC5B,IAAIF,MAAM,GAAG/G,MAAM,CAAC6F,IAAI,CAACoB,GAAG,CAAC;MAC7B,IAAI1B,YAAY,GAAG,CAAC,CAAC;MACrBwB,MAAM,CAACtB,OAAO,CAAC,UAAUR,KAAK,EAAE;QAC5B,IAAIN,EAAE;QACN,IAAIX,IAAI,GAAGiD,GAAG,CAAChC,KAAK,CAAC;QACrB,IAAIkB,IAAI,GAAG7D,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;QACjC,IAAIQ,IAAI,EAAE;UACN,IAAIoB,IAAI,GAAG,CAAC,CAAC;UACb,IAAI,OAAO,IAAIpB,IAAI,EAAE;YACjBoB,IAAI,CAAC8B,MAAM,GAAGlD,IAAI,CAACvC,KAAK;UAC5B;UACA,IAAI,SAAS,IAAIuC,IAAI,EAAE;YACnBoB,IAAI,CAAC+B,QAAQ,GAAGnD,IAAI,CAACoD,OAAO;UAChC;UACA,IAAI,SAAS,IAAIpD,IAAI,EAAE;YACnBoB,IAAI,CAACiC,OAAO,GAAGrD,IAAI,CAACqD,OAAO;UAC/B;UACA,IAAI,OAAO,IAAIrD,IAAI,EAAE;YACjBzB,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAEjB,IAAI,CAACxC,KAAK,CAAC;YACnC+D,YAAY,CAACN,KAAK,CAAC,GAAGjB,IAAI,CAACxC,KAAK;UACpC;UACAwB,KAAK,CAACkC,MAAM,CAAC,eAAe,EAAE;YAC1BoC,IAAI,EAAElC,IAAI;YACVe,IAAI,EAAEA,IAAI;YACVlB,KAAK,EAAEA,KAAK;YACZM,YAAY,GAAGZ,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAACM,KAAK,CAAC,GAAGjB,IAAI,CAACxC,KAAK,EAAEmD,EAAE;UACtD,CAAC,CAAC;QACN;MACJ,CAAC,CAAC;MACF3B,KAAK,CAACoD,mBAAmB,CAACb,YAAY,CAAC;IAC3C,CAAC;IACD,IAAI,CAACgC,aAAa,GAAG,UAAUtC,KAAK,EAAE;MAClC,OAAO3C,SAAS,CAACJ,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEyB,KAAK,CAAC,CAAC;IAC7C,CAAC;IACD;IACA,IAAI,CAACuC,aAAa,GAAG,UAAUvC,KAAK,EAAE;MAClC,IAAIjB,IAAI,GAAGhB,KAAK,CAACgC,kBAAkB,CAACC,KAAK,CAAC;MAC1C,OAAOjB,IAAI,GAAGA,IAAI,CAACyD,SAAS,CAAC,CAAC,GAAG,IAAI;IACzC,CAAC;IACD;IACA,IAAI,CAACC,cAAc,GAAG,UAAUX,MAAM,EAAE;MACpC,IAAIG,MAAM,GAAG,CAAC,CAAC;MACf,IAAIzE,OAAO,CAACsE,MAAM,CAAC,EAAE;QACjBA,MAAM,CAACJ,GAAG,CAAC,UAAU1B,KAAK,EAAE;UACxB,IAAIxD,KAAK,GAAGuB,KAAK,CAACwE,aAAa,CAACvC,KAAK,CAAC;UACtC,IAAIxD,KAAK,EAAE;YACPyF,MAAM,CAACjC,KAAK,CAAC,GAAGxD,KAAK;UACzB;QACJ,CAAC,CAAC;MACN,CAAC,MACI;QACDuB,KAAK,CAACuB,mBAAmB,CAAC,IAAI,EAAE;UAAEM,eAAe,EAAE;QAAK,CAAC,CAAC,CAACY,OAAO,CAAC,UAAUzB,IAAI,EAAE;UAC/E,IAAIA,IAAI,CAACyD,SAAS,CAAC,CAAC,EAAE;YAClBP,MAAM,CAAClD,IAAI,CAACc,KAAK,CAACG,KAAK,CAAC,GAAGjB,IAAI,CAACyD,SAAS,CAAC,CAAC;UAC/C;QACJ,CAAC,CAAC;MACN;MACA,OAAOP,MAAM;IACjB,CAAC;IACD,IAAI,CAACS,SAAS,GAAG,YAAY;MACzB,OAAOrF,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;IACjC,CAAC;IACD,IAAI,CAACoE,cAAc,GAAG,UAAUb,MAAM,EAAE;MACpC,IAAIjD,MAAM,GAAG,CAAC,CAAC;MACf,IAAIrB,OAAO,CAACsE,MAAM,CAAC,EAAE;QACjBA,MAAM,CAACtB,OAAO,CAAC,UAAUoC,GAAG,EAAE;UAC1BtF,GAAG,CAACuB,MAAM,EAAE+D,GAAG,EAAE7E,KAAK,CAACuE,aAAa,CAACM,GAAG,CAAC,CAAC;QAC9C,CAAC,CAAC;QACF,OAAO/D,MAAM;MACjB;MACAd,KAAK,CAACuB,mBAAmB,CAAC,IAAI,CAAC,CAACkB,OAAO,CAAC,UAAUd,EAAE,EAAE;QAClD,IAAIM,KAAK,GAAGN,EAAE,CAACG,KAAK,CAACG,KAAK;QAC1B,IAAIzD,KAAK,GAAGU,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEyB,KAAK,CAAC;QACnC1C,GAAG,CAACuB,MAAM,EAAEmB,KAAK,EAAEzD,KAAK,CAAC;MAC7B,CAAC,CAAC;MACF,OAAOsC,MAAM;IACjB,CAAC;IACD,IAAI,CAACgE,WAAW,GAAG,UAAUC,SAAS,EAAE;MACpC,IAAI5B,IAAI,GAAG7D,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;MACjC,IAAIuD,MAAM,GAAGnE,OAAO,CAACmF,SAAS,CAAC,IAAI,CAACtF,OAAO,CAACsF,SAAS,CAAC,GAAG,CAACA,SAAS,CAAC,GAAGA,SAAS;MAChF,IAAIhB,MAAM,IAAItE,OAAO,CAACsE,MAAM,CAAC,EAAE;QAC3B,IAAIiB,cAAc,GAAG,CAAC,CAAC;QACvBjB,MAAM,CAACtB,OAAO,CAAC,UAAUR,KAAK,EAAE;UAC5B1C,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAEjC,KAAK,CAACS,aAAa,CAACwB,KAAK,CAAC,CAAC;UACnD+C,cAAc,CAAC/C,KAAK,CAAC,GAAG/C,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEyB,KAAK,CAAC;QACnD,CAAC,CAAC;QACFjC,KAAK,CAACoD,mBAAmB,CAAC4B,cAAc,CAAC;QACzChF,KAAK,CAACkC,MAAM,CAAC,OAAO,EAAE;UAAEiB,IAAI,EAAEA,IAAI;UAAElB,KAAK,EAAE8B;QAAO,CAAC,CAAC;QACpD/D,KAAK,CAACiF,cAAc,CAAClB,MAAM,CAAC;MAChC,CAAC,MACI;QACD,IAAImB,WAAW,GAAG,CAAC,CAAC;QACpB,IAAIC,cAAc,GAAG7F,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;QAC3CxD,MAAM,CAAC6F,IAAI,CAAC7C,KAAK,CAACS,aAAa,CAAC,CAACgC,OAAO,CAAC,UAAUR,KAAK,EAAE;UACtD1C,GAAG,CAAC2F,WAAW,EAAEjD,KAAK,EAAEjC,KAAK,CAACS,aAAa,CAACwB,KAAK,CAAC,CAAC;QACvD,CAAC,CAAC;QACFjC,KAAK,CAACQ,KAAK,GAAG0E,WAAW;QACzBlF,KAAK,CAACuB,mBAAmB,CAAC,IAAI,CAAC,CAACkB,OAAO,CAAC,UAAUzB,IAAI,EAAE;UACpD,IAAI6D,GAAG,GAAG7D,IAAI,CAACc,KAAK,CAACG,KAAK;UAC1B1C,GAAG,CAAC4F,cAAc,EAAEN,GAAG,EAAE3F,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEqE,GAAG,CAAC,CAAC;QACnD,CAAC,CAAC;QACF7E,KAAK,CAACoD,mBAAmB,CAAC+B,cAAc,CAAC;QACzCnF,KAAK,CAACiF,cAAc,CAAC,CAAC;QACtBjF,KAAK,CAACkC,MAAM,CAAC,OAAO,EAAE;UAAEiB,IAAI,EAAEA,IAAI;UAAElB,KAAK,EAAEjF,MAAM,CAAC6F,IAAI,CAACsC,cAAc;QAAE,CAAC,CAAC;MAC7E;IACJ,CAAC;IACD;IACA,IAAI,CAACC,QAAQ,GAAGtF,SAAS,CAAC,UAAUuF,wBAAwB,EAAEC,UAAU,EAAEC,EAAE,EAAE;MAC1E,IAAIC,QAAQ,GAAGxF,KAAK,CAACuB,mBAAmB,CAAC,IAAI,EAAE;QAC3CM,eAAe,EAAE;MACrB,CAAC,CAAC;MACF,IAAI4D,YAAY,GAAGhG,OAAO,CAAC4F,wBAAwB,CAAC,IAAIA,wBAAwB,CAAC9H,MAAM,GACjFiI,QAAQ,CAACvE,MAAM,CAAC,UAAUC,CAAC,EAAE;QAAE,OAAOmE,wBAAwB,CAACK,OAAO,CAACxE,CAAC,CAACY,KAAK,CAACG,KAAK,CAAC,GAAG,CAAC,CAAC;MAAE,CAAC,CAAC,GAC9FuD,QAAQ;MACd,IAAI/D,OAAO,GAAG9B,QAAQ,CAAC0F,wBAAwB,CAAC,GAC1CA,wBAAwB,GACxB1F,QAAQ,CAAC2F,UAAU,CAAC,GAChBA,UAAU,GACV,CAAC,CAAC;MACZ,IAAIK,QAAQ,GAAGjG,UAAU,CAAC2F,wBAAwB,CAAC,GAC7CA,wBAAwB,GACxB3F,UAAU,CAAC4F,UAAU,CAAC,GAClBA,UAAU,GACVC,EAAE,IAAK,YAAY,CAAE,CAAE;MACjC,IAAIK,QAAQ,GAAGH,YAAY,CAAC9B,GAAG,CAAC,UAAUzC,CAAC,EAAE;QACzC,OAAO,CAACO,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACoE,YAAY,IAAI3E,CAAC,CAAC4E,iBAAiB,CAAC,CAAC,GAAG5E,CAAC,CAAC6E,aAAa,CAAC,CAAC;MAC/H,CAAC,CAAC;MACF,IAAIC,cAAc,GAAG,SAAAA,CAAU9B,MAAM,EAAE;QACnC,IAAI,EAAEzC,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACoE,YAAY,CAAC,EAAE;UAC3E,IAAII,gBAAgB,GAAGjG,KAAK,CAACU,SAAS,CAACsF,cAAc;UACrDC,gBAAgB,IAAIA,gBAAgB,CAAC/B,MAAM,CAAC;QAChD;MACJ,CAAC;MACDgC,OAAO,CAACC,GAAG,CAACP,QAAQ,CAAC,CAACQ,IAAI,CAAC,UAAUC,MAAM,EAAE;QACzC,IAAInC,MAAM,GAAG,CAAC,CAAC;QACf,IAAIpD,MAAM,GAAG,CAAC,CAAC;QACfuF,MAAM,CAAC1C,GAAG,CAAC,UAAUzC,CAAC,EAAE;UACpB,IAAIS,EAAE;UACN,IAAIT,CAAC,CAACzC,KAAK,EAAE;YACTyF,MAAM,GAAGnH,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEmH,MAAM,CAAC,EAAEhD,CAAC,CAACzC,KAAK,CAAC;UACpD;UACA,IAAIuC,IAAI,GAAGhB,KAAK,CAACgC,kBAAkB,CAACd,CAAC,CAACe,KAAK,CAAC;UAC5C,IAAI,EAAE,CAACN,EAAE,GAAGX,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACc,KAAK,MAAM,IAAI,IAAIH,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACI,UAAU,CAAC,EAAE;YACrH;YACAxC,GAAG,CAACuB,MAAM,EAAEI,CAAC,CAACe,KAAK,EAAEf,CAAC,CAAC1C,KAAK,CAAC;UACjC;QACJ,CAAC,CAAC;QACF,IAAIxB,MAAM,CAAC6F,IAAI,CAACqB,MAAM,CAAC,CAAC3G,MAAM,EAAE;UAC5ByI,cAAc,CAAC9B,MAAM,CAAC;UACtByB,QAAQ,IAAIA,QAAQ,CAACzB,MAAM,EAAE5E,SAAS,CAACwB,MAAM,CAAC,CAAC;QACnD,CAAC,MACI;UACD6E,QAAQ,IAAIA,QAAQ,CAAC,IAAI,EAAErG,SAAS,CAACwB,MAAM,CAAC,CAAC;QACjD;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;IACF,IAAI,CAACwF,kBAAkB,GAAG,UAAUrG,YAAY,EAAE;MAC9CD,KAAK,CAACC,YAAY,GAAGA,YAAY;MACjCD,KAAK,CAACW,qBAAqB,CAAC,CAAC;MAC7BX,KAAK,CAACuG,iBAAiB,CAAC,CAAC;IAC7B,CAAC;IACD,IAAI,CAACC,MAAM,GAAG,YAAY;MACtBxG,KAAK,CAACsG,kBAAkB,CAACzG,YAAY,CAAC4G,UAAU,CAAC;MACjDzG,KAAK,CAACoF,QAAQ,CAAC,UAAUlB,MAAM,EAAEpD,MAAM,EAAE;QACrC,IAAIuF,MAAM;QACV,IAAI1E,EAAE,GAAG3B,KAAK,CAACU,SAAS;UAAEgG,QAAQ,GAAG/E,EAAE,CAAC+E,QAAQ;UAAEC,cAAc,GAAGhF,EAAE,CAACgF,cAAc;QACpF,IAAI,CAACzC,MAAM,IAAIwC,QAAQ,EAAE;UACrBL,MAAM,GAAGK,QAAQ,CAAC5F,MAAM,CAAC;QAC7B;QACA,IAAIoD,MAAM,IAAIyC,cAAc,EAAE;UAC1BN,MAAM,GAAGM,cAAc,CAACzC,MAAM,CAAC;QACnC;QACA,IAAImC,MAAM,IAAIA,MAAM,CAACD,IAAI,EAAE;UACvB;UACAC,MAAM,CACDD,IAAI,CAAC,UAAU9B,IAAI,EAAE;YACtBtE,KAAK,CAACsG,kBAAkB,CAACzG,YAAY,CAAC+G,OAAO,CAAC;YAC9C,OAAOtC,IAAI;UACf,CAAC,CAAC,CACGuC,KAAK,CAAC,UAAUpI,KAAK,EAAE;YACxB;YACAuB,KAAK,CAACsG,kBAAkB,CAACzG,YAAY,CAACpB,KAAK,CAAC;YAC5C,OAAOyH,OAAO,CAACY,MAAM,CAACrI,KAAK,CAAC;UAChC,CAAC,CAAC;QACN,CAAC,MACI;UACDuB,KAAK,CAACsG,kBAAkB,CAACpC,MAAM,GAAGrE,YAAY,CAACpB,KAAK,GAAGoB,YAAY,CAAC+G,OAAO,CAAC;QAChF;MACJ,CAAC,CAAC;IACN,CAAC;IACD,IAAI,CAACG,cAAc,GAAG,UAAUhD,MAAM,EAAE;MACpC,IAAIsC,MAAM,GAAG,CAAC,CAAC;MACf,IAAIW,YAAY,GAAG,SAAAA,CAAUhG,IAAI,EAAE;QAC/B,IAAI,CAACA,IAAI,EAAE;UACP,OAAO,IAAI;QACf;QACA,IAAIvC,KAAK,GAAGuC,IAAI,CAACyD,SAAS,CAAC,CAAC;QAC5B,OAAO;UACHP,MAAM,EAAEzF,KAAK,GAAG,CAACA,KAAK,CAAC,GAAG,EAAE;UAC5B0F,QAAQ,EAAEnD,IAAI,CAACiG,WAAW,CAAC,CAAC;UAC5BC,cAAc,EAAElG,IAAI,CAACmG,iBAAiB,CAAC,CAAC;UACxCC,YAAY,EAAEpH,KAAK,CAACC,YAAY,KAAKJ,YAAY,CAAC4G,UAAU;UAC5D/C,SAAS,EAAE1C,IAAI,CAAC0C,SAAS,CAAC,CAAC;UAC3BlF,KAAK,EAAEwB,KAAK,CAACuE,aAAa,CAACvD,IAAI,CAACc,KAAK,CAACG,KAAK;QAC/C,CAAC;MACL,CAAC;MACD,IAAIxC,OAAO,CAACsE,MAAM,CAAC,EAAE;QACjBA,MAAM,CAACtB,OAAO,CAAC,UAAUoC,GAAG,EAAE;UAC1BwB,MAAM,CAACxB,GAAG,CAAC,GAAGmC,YAAY,CAAChH,KAAK,CAACgC,kBAAkB,CAAC6C,GAAG,CAAC,CAAC;QAC7D,CAAC,CAAC;QACF,OAAOwB,MAAM;MACjB;MACArG,KAAK,CAACuB,mBAAmB,CAAC,IAAI,CAAC,CAACkB,OAAO,CAAC,UAAUzB,IAAI,EAAE;QACpDqF,MAAM,CAACrF,IAAI,CAACc,KAAK,CAACG,KAAK,CAAC,GAAG+E,YAAY,CAAChG,IAAI,CAAC;MACjD,CAAC,CAAC;MACF,OAAOqF,MAAM;IACjB,CAAC;IACD,IAAI,CAACgB,WAAW,GAAG,UAAUtC,SAAS,EAAE;MACpC,IAAI5B,IAAI,GAAG7D,SAAS,CAACU,KAAK,CAACQ,KAAK,CAAC;MACjC,IAAIuD,MAAM,GAAGnE,OAAO,CAACmF,SAAS,CAAC,IAAI,CAACtF,OAAO,CAACsF,SAAS,CAAC,GAAG,CAACA,SAAS,CAAC,GAAGA,SAAS;MAChF,IAAIhB,MAAM,IAAItE,OAAO,CAACsE,MAAM,CAAC,EAAE;QAC3B,IAAIuD,cAAc,GAAG,CAAC,CAAC;QACvBvD,MAAM,CAACtB,OAAO,CAAC,UAAUR,KAAK,EAAE;UAC5B1C,GAAG,CAACS,KAAK,CAACQ,KAAK,EAAEyB,KAAK,EAAEsF,SAAS,CAAC;UAClCD,cAAc,CAACrF,KAAK,CAAC,GAAG/C,GAAG,CAACc,KAAK,CAACQ,KAAK,EAAEyB,KAAK,CAAC;QACnD,CAAC,CAAC;QACFjC,KAAK,CAACoD,mBAAmB,CAACkE,cAAc,CAAC;QACzCtH,KAAK,CAACkC,MAAM,CAAC,eAAe,EAAE;UAC1BiB,IAAI,EAAEA,IAAI;UACVlB,KAAK,EAAE8B,MAAM;UACbO,IAAI,EAAE;YACFJ,MAAM,EAAE,IAAI;YACZC,QAAQ,EAAE;UACd;QACJ,CAAC,CAAC;QACF;MACJ,CAAC,MACI;QACD,IAAIqD,cAAc,GAAG,CAAC,CAAC;QACvBxH,KAAK,CAACQ,KAAK,GAAG,CAAC,CAAC;QAChBR,KAAK,CAACuB,mBAAmB,CAAC,IAAI,CAAC,CAACkB,OAAO,CAAC,UAAUzB,IAAI,EAAE;UACpD,IAAI6D,GAAG,GAAG7D,IAAI,CAACc,KAAK,CAACG,KAAK;UAC1B1C,GAAG,CAACiI,cAAc,EAAE3C,GAAG,EAAE0C,SAAS,CAAC;QACvC,CAAC,CAAC;QACFvH,KAAK,CAACoD,mBAAmB,CAACoE,cAAc,CAAC;QACzC;QACAxH,KAAK,CAACkC,MAAM,CAAC,eAAe,EAAE;UAC1BiB,IAAI,EAAEA,IAAI;UACVlB,KAAK,EAAEjF,MAAM,CAAC6F,IAAI,CAAC2E,cAAc,CAAC;UAClClD,IAAI,EAAE;YACFJ,MAAM,EAAE,IAAI;YACZC,QAAQ,EAAE;UACd;QACJ,CAAC,CAAC;MACN;IACJ,CAAC;EACL;EACApE,KAAK,CAACtC,SAAS,CAAC6D,cAAc,GAAG,YAAY;IACzC,IAAI,CAAClB,gBAAgB,CAACqC,OAAO,CAAC,UAAUzB,IAAI,EAAE;MAC1CA,IAAI,CAAC,CAAC;IACV,CAAC,CAAC;EACN,CAAC;EACD;EACAjB,KAAK,CAACtC,SAAS,CAAC8I,iBAAiB,GAAG,YAAY;IAC5C,IAAI,CAACjG,oBAAoB,CAACmC,OAAO,CAAC,UAAUzB,IAAI,EAAE;MAC9CA,IAAI,CAAC,CAAC;IACV,CAAC,CAAC;EACN,CAAC;EACDjB,KAAK,CAACtC,SAAS,CAACmD,mBAAmB,GAAG,YAAY;IAC9C,IAAI,CAACP,qBAAqB,CAACoC,OAAO,CAAC,UAAUzB,IAAI,EAAE;MAC/CA,IAAI,CAAC,CAAC;IACV,CAAC,CAAC;EACN,CAAC;EACDjB,KAAK,CAACtC,SAAS,CAAC2F,mBAAmB,GAAG,UAAU5E,KAAK,EAAE;IACnD,IAAIA,KAAK,IAAIxB,MAAM,CAAC6F,IAAI,CAACrE,KAAK,CAAC,CAACjB,MAAM,EAAE;MACpC,IAAIkK,cAAc,GAAG,IAAI,CAAC/G,SAAS,CAAC+G,cAAc;MAClDA,cAAc,IAAIA,cAAc,CAACjJ,KAAK,EAAE,IAAI,CAACmG,SAAS,CAAC,CAAC,CAAC;IAC7D;IACA,IAAI,CAACrD,cAAc,CAAC,CAAC;EACzB,CAAC;EACDvB,KAAK,CAACtC,SAAS,CAAC4F,kBAAkB,GAAG,UAAU7E,KAAK,EAAE;IAClD,IAAIA,KAAK,IAAIxB,MAAM,CAAC6F,IAAI,CAACrE,KAAK,CAAC,CAACjB,MAAM,EAAE;MACpC,IAAImK,QAAQ,GAAG,IAAI,CAAChH,SAAS,CAACgH,QAAQ;MACtCA,QAAQ,IAAIA,QAAQ,CAAClJ,KAAK,EAAE,IAAI,CAACmG,SAAS,CAAC,CAAC,CAAC;IACjD;EACJ,CAAC;EACD5E,KAAK,CAACtC,SAAS,CAAC+E,0BAA0B,GAAG,UAAUP,KAAK,EAAE;IAC1D,IAAI,CAACA,KAAK,EAAE;MACR,OAAO,EAAE;IACb;IACA,IAAI8B,MAAM,GAAG,EAAE,CAAC9E,MAAM,CAACgD,KAAK,CAAC;IAC7B,IAAIY,IAAI,GAAGkB,MAAM,CACZJ,GAAG,CAAC,UAAU3C,IAAI,EAAE;MAAE,OAAOxB,kBAAkB,CAACD,GAAG,CAAC,CAAC,CAAC,EAAEyB,IAAI,EAAEuG,SAAS,CAAC,CAAC;IAAE,CAAC,CAAC,CAC7EI,MAAM,CAAC,UAAUC,KAAK,EAAEvJ,IAAI,EAAE;MAC/B,OAAOuJ,KAAK,CAAC3I,MAAM,CAACZ,IAAI,CAAC;IAC7B,CAAC,EAAE,EAAE,CAAC;IACN,OAAOK,aAAa,CAAC,CAACuD,KAAK,CAAC,EAAEpE,MAAM,CAACgF,IAAI,CAAC,EAAE,KAAK,CAAC;EACtD,CAAC;EACD9C,KAAK,CAACtC,SAAS,CAACsF,cAAc,GAAG,UAAUd,KAAK,EAAE;IAC9C,IAAIjC,KAAK,GAAG,IAAI;IAChB,IAAI6C,IAAI,GAAG,IAAI,CAACL,0BAA0B,CAACP,KAAK,CAAC;IACjD;IACA,OAAOY,IAAI,CAACgF,IAAI,CAAC,UAAU7G,IAAI,EAAE;MAAE,OAAO5B,GAAG,CAACY,KAAK,CAACO,aAAa,EAAES,IAAI,CAAC;IAAE,CAAC,CAAC;EAChF,CAAC;EACDjB,KAAK,CAACtC,SAAS,CAACwH,cAAc,GAAG,UAAUhD,KAAK,EAAE;IAC9C,IAAIA,KAAK,KAAKsF,SAAS,EAAE;MACrB,IAAI,CAAChH,aAAa,GAAG,CAAC,CAAC;IAC3B;IACA,IAAIsC,IAAI,GAAG,IAAI,CAACL,0BAA0B,CAACP,KAAK,CAAC;IACjD,IAAI,CAAC1B,aAAa,GAAGlB,IAAI,CAAC,IAAI,CAACkB,aAAa,EAAEsC,IAAI,CAAC;EACvD,CAAC;EACD9C,KAAK,CAACtC,SAAS,CAAC6E,eAAe,GAAG,UAAUL,KAAK,EAAE;IAC/C,IAAIjC,KAAK,GAAG,IAAI;IAChB,EAAE,CAACf,MAAM,CAACgD,KAAK,CAAC,CAACQ,OAAO,CAAC,UAAUoC,GAAG,EAAE;MACpC1F,OAAO,CAACa,KAAK,CAACO,aAAa,EAAEsE,GAAG,EAAE0C,SAAS,EAAEvK,MAAM,CAAC;IACxD,CAAC,CAAC;EACN,CAAC;EACD,OAAO+C,KAAK;AAChB,CAAC,CAAC,CAAE;AACJ,eAAeA,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}