{"ast":null,"code":"import { useCallback, useContext, useEffect, useRef } from 'react';\nimport { SubmitStatus } from '../interface';\nimport { FormContext } from '../context';\nimport warn from '../../_util/warning';\nimport useForceUpdate from '../../_util/hooks/useForceUpdate';\n/**\n * useFormContext 只会返回一些 Form 全局的状态，避免返回某个表单项的状态\n */\nvar useFormContext = function () {\n  var formCtx = useContext(FormContext);\n  var formInstance = formCtx.store;\n  var isSubmittingRef = useRef(false);\n  var forceUpdate = useForceUpdate();\n  var setSubmitting = useCallback(function () {\n    var _a, _b;\n    var submitStatus = (((_b = (_a = formInstance === null || formInstance === void 0 ? void 0 : formInstance.getInnerMethods(true)) === null || _a === void 0 ? void 0 : _a.innerGetStoreStatus) === null || _b === void 0 ? void 0 : _b.call(_a)) || {}).submitStatus;\n    var newIsSubmitting = submitStatus === SubmitStatus.submitting;\n    if (newIsSubmitting !== isSubmittingRef.current) {\n      isSubmittingRef.current = newIsSubmitting;\n      forceUpdate();\n    }\n  }, []);\n  useEffect(function () {\n    if (!formInstance) {\n      warn(true, 'formInstance is not available');\n      return;\n    }\n    var registerFormWatcher = (formInstance === null || formInstance === void 0 ? void 0 : formInstance.getInnerMethods(true)).registerFormWatcher;\n    var update = function () {\n      return setSubmitting();\n    };\n    update();\n    var cancelWatch = registerFormWatcher && registerFormWatcher(update);\n    return function () {\n      cancelWatch === null || cancelWatch === void 0 ? void 0 : cancelWatch();\n    };\n  }, []);\n  return {\n    form: formInstance,\n    disabled: formCtx.disabled,\n    isSubmitting: isSubmittingRef.current\n  };\n};\nexport default useFormContext;","map":{"version":3,"names":["useCallback","useContext","useEffect","useRef","SubmitStatus","FormContext","warn","useForceUpdate","useFormContext","formCtx","formInstance","store","isSubmittingRef","forceUpdate","setSubmitting","_a","_b","submitStatus","getInnerMethods","innerGetStoreStatus","call","newIsSubmitting","submitting","current","registerFormWatcher","update","cancelWatch","form","disabled","isSubmitting"],"sources":["D:/Nodejs/oj-frontend/node_modules/@arco-design/web-react/es/Form/hooks/useContext.js"],"sourcesContent":["import { useCallback, useContext, useEffect, useRef } from 'react';\nimport { SubmitStatus } from '../interface';\nimport { FormContext } from '../context';\nimport warn from '../../_util/warning';\nimport useForceUpdate from '../../_util/hooks/useForceUpdate';\n/**\n * useFormContext 只会返回一些 Form 全局的状态，避免返回某个表单项的状态\n */\nvar useFormContext = function () {\n    var formCtx = useContext(FormContext);\n    var formInstance = formCtx.store;\n    var isSubmittingRef = useRef(false);\n    var forceUpdate = useForceUpdate();\n    var setSubmitting = useCallback(function () {\n        var _a, _b;\n        var submitStatus = (((_b = (_a = formInstance === null || formInstance === void 0 ? void 0 : formInstance.getInnerMethods(true)) === null || _a === void 0 ? void 0 : _a.innerGetStoreStatus) === null || _b === void 0 ? void 0 : _b.call(_a)) || {}).submitStatus;\n        var newIsSubmitting = submitStatus === SubmitStatus.submitting;\n        if (newIsSubmitting !== isSubmittingRef.current) {\n            isSubmittingRef.current = newIsSubmitting;\n            forceUpdate();\n        }\n    }, []);\n    useEffect(function () {\n        if (!formInstance) {\n            warn(true, 'formInstance is not available');\n            return;\n        }\n        var registerFormWatcher = (formInstance === null || formInstance === void 0 ? void 0 : formInstance.getInnerMethods(true)).registerFormWatcher;\n        var update = function () { return setSubmitting(); };\n        update();\n        var cancelWatch = registerFormWatcher && registerFormWatcher(update);\n        return function () {\n            cancelWatch === null || cancelWatch === void 0 ? void 0 : cancelWatch();\n        };\n    }, []);\n    return {\n        form: formInstance,\n        disabled: formCtx.disabled,\n        isSubmitting: isSubmittingRef.current,\n    };\n};\nexport default useFormContext;\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAClE,SAASC,YAAY,QAAQ,cAAc;AAC3C,SAASC,WAAW,QAAQ,YAAY;AACxC,OAAOC,IAAI,MAAM,qBAAqB;AACtC,OAAOC,cAAc,MAAM,kCAAkC;AAC7D;AACA;AACA;AACA,IAAIC,cAAc,GAAG,SAAAA,CAAA,EAAY;EAC7B,IAAIC,OAAO,GAAGR,UAAU,CAACI,WAAW,CAAC;EACrC,IAAIK,YAAY,GAAGD,OAAO,CAACE,KAAK;EAChC,IAAIC,eAAe,GAAGT,MAAM,CAAC,KAAK,CAAC;EACnC,IAAIU,WAAW,GAAGN,cAAc,CAAC,CAAC;EAClC,IAAIO,aAAa,GAAGd,WAAW,CAAC,YAAY;IACxC,IAAIe,EAAE,EAAEC,EAAE;IACV,IAAIC,YAAY,GAAG,CAAC,CAAC,CAACD,EAAE,GAAG,CAACD,EAAE,GAAGL,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACQ,eAAe,CAAC,IAAI,CAAC,MAAM,IAAI,IAAIH,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACI,mBAAmB,MAAM,IAAI,IAAIH,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACI,IAAI,CAACL,EAAE,CAAC,KAAK,CAAC,CAAC,EAAEE,YAAY;IACnQ,IAAII,eAAe,GAAGJ,YAAY,KAAKb,YAAY,CAACkB,UAAU;IAC9D,IAAID,eAAe,KAAKT,eAAe,CAACW,OAAO,EAAE;MAC7CX,eAAe,CAACW,OAAO,GAAGF,eAAe;MACzCR,WAAW,CAAC,CAAC;IACjB;EACJ,CAAC,EAAE,EAAE,CAAC;EACNX,SAAS,CAAC,YAAY;IAClB,IAAI,CAACQ,YAAY,EAAE;MACfJ,IAAI,CAAC,IAAI,EAAE,+BAA+B,CAAC;MAC3C;IACJ;IACA,IAAIkB,mBAAmB,GAAG,CAACd,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACQ,eAAe,CAAC,IAAI,CAAC,EAAEM,mBAAmB;IAC9I,IAAIC,MAAM,GAAG,SAAAA,CAAA,EAAY;MAAE,OAAOX,aAAa,CAAC,CAAC;IAAE,CAAC;IACpDW,MAAM,CAAC,CAAC;IACR,IAAIC,WAAW,GAAGF,mBAAmB,IAAIA,mBAAmB,CAACC,MAAM,CAAC;IACpE,OAAO,YAAY;MACfC,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAAC,CAAC;IAC3E,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;EACN,OAAO;IACHC,IAAI,EAAEjB,YAAY;IAClBkB,QAAQ,EAAEnB,OAAO,CAACmB,QAAQ;IAC1BC,YAAY,EAAEjB,eAAe,CAACW;EAClC,CAAC;AACL,CAAC;AACD,eAAef,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}