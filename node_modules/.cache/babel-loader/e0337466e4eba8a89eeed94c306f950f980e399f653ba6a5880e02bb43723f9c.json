{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nimport merge from 'lodash/merge';\nimport { useEffect, useRef, useState } from 'react';\nimport { isServerRendering } from '../../_util/dom';\nimport { getPixelRatio } from './utils';\nimport { isNumber } from '../../_util/is';\nvar toNumber = function (value, defaultValue) {\n  if (isNumber(value)) {\n    return value;\n  }\n  var numberVal = parseFloat(value);\n  return isNumber(numberVal) ? numberVal : defaultValue;\n};\nvar defaultOptions = {\n  width: 100,\n  gap: [100, 100],\n  fontStyle: {\n    fontSize: '16px',\n    color: 'rgba(0, 0, 0, 0.15)',\n    fontFamily: 'sans-serif',\n    fontWeight: 'normal'\n  },\n  getContainer: function () {\n    return document.body;\n  }\n};\n// 计量文本宽度和高度。\nvar measureTextSize = function (ctx, contents, rotate) {\n  var width = 0;\n  var height = 0;\n  var lineSize = [];\n  contents.forEach(function (content) {\n    var _a = ctx.measureText(content),\n      textWidth = _a.width,\n      fontBoundingBoxAscent = _a.fontBoundingBoxAscent,\n      fontBoundingBoxDescent = _a.fontBoundingBoxDescent;\n    var textHeight = fontBoundingBoxAscent + fontBoundingBoxDescent;\n    if (textWidth > width) {\n      width = textWidth;\n    }\n    height += textHeight;\n    lineSize.push({\n      height: textHeight,\n      width: textWidth\n    });\n  });\n  var angle = rotate * Math.PI / 180;\n  return {\n    originWidth: width,\n    originHeight: height,\n    // rotate 旋转后的实际占位宽度\n    width: Math.ceil(Math.abs(Math.sin(angle) * height) + Math.abs(Math.cos(angle) * width)),\n    // rotate 旋转后的实际占位高度\n    height: Math.ceil(Math.abs(Math.sin(angle) * width) + Math.abs(height * Math.cos(angle))),\n    lineSize: lineSize\n  };\n};\n// 画布绘制转为base64url\nvar getCanvasData = function (options) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    var offset, rotate, image, content, fontStyle, canvas, ctx, ratio, contents, setCanvas, renderContent;\n    return __generator(this, function (_a) {\n      offset = options.offset, rotate = options.rotate, image = options.image, content = options.content, fontStyle = options.fontStyle;\n      canvas = document.createElement('canvas');\n      ctx = canvas.getContext('2d');\n      ratio = getPixelRatio(ctx);\n      contents = [].concat(content || '');\n      setCanvas = function (_a) {\n        var height = _a.height,\n          width = _a.width;\n        var canvasWidth = 2 * offset[0] + width;\n        var canvasHeight = 2 * offset[1] + height;\n        canvas.setAttribute('width', canvasWidth * ratio + \"px\");\n        canvas.setAttribute('height', canvasHeight * ratio + \"px\");\n        canvas.style.width = canvasWidth + \"px\";\n        canvas.style.height = canvasHeight + \"px\";\n        ctx.translate(canvasWidth * ratio / 2, canvasHeight * ratio / 2);\n        ctx.scale(ratio, ratio);\n        var RotateAngle = rotate * Math.PI / 180;\n        ctx.rotate(RotateAngle);\n      };\n      renderContent = function () {\n        var fontSize = fontStyle.fontSize,\n          color = fontStyle.color,\n          fontWeight = fontStyle.fontWeight,\n          fontFamily = fontStyle.fontFamily;\n        var realFontSize = toNumber(fontSize, 0) || fontStyle.fontSize;\n        // font, scale 需参与文本尺寸计量\n        ctx.font = fontWeight + \" \" + realFontSize + \"px \" + fontFamily;\n        var measureSize = measureTextSize(ctx, contents, rotate);\n        var width = options.width || measureSize.width;\n        var height = options.height || measureSize.height;\n        setCanvas({\n          width: width,\n          height: height\n        });\n        ctx.fillStyle = color;\n        ctx.font = fontWeight + \" \" + realFontSize + \"px \" + fontFamily;\n        // 如果不设置，会导致旋转后的部分文字被遮盖\n        ctx.textBaseline = 'top';\n        contents.forEach(function (content, index) {\n          var _a = measureSize.lineSize[index],\n            lineHeight = _a.height,\n            lineWidth = _a.width;\n          var xStartPoint = -lineWidth / 2;\n          var yStartPoint = -(options.height || measureSize.originHeight) / 2 + lineHeight * index;\n          ctx.fillText(content, xStartPoint, yStartPoint, options.width || measureSize.originWidth);\n        });\n        return {\n          base64Url: canvas.toDataURL(),\n          height: height,\n          width: width\n        };\n      };\n      if (image) {\n        return [2 /*return*/, new Promise(function (resolve) {\n          var img = new Image();\n          img.crossOrigin = 'anonymous';\n          img.referrerPolicy = 'no-referrer';\n          img.src = image;\n          img.onload = function () {\n            var width = options.width,\n              height = options.height;\n            if (!width || !height) {\n              if (width) {\n                height = img.height / img.width * width;\n              } else {\n                width = img.width / img.height * height;\n              }\n            }\n            setCanvas({\n              width: width,\n              height: height\n            });\n            ctx.drawImage(img, -width / 2, -height / 2, width, height);\n            return resolve({\n              base64Url: canvas.toDataURL(),\n              width: width,\n              height: height\n            });\n          };\n          img.onerror = function () {\n            return renderContent();\n          };\n        })];\n      }\n      return [2 /*return*/, renderContent()];\n    });\n  });\n};\nvar getMergeOptions = function (o) {\n  var _a, _b, _c, _d, _e, _f;\n  var options = o || {};\n  var _options = __assign(__assign({\n    rotate: -20,\n    zIndex: 1\n  }, options), {\n    fontStyle: __assign(__assign({}, defaultOptions.fontStyle), options.fontStyle),\n    width: toNumber(options.width, options.image ? defaultOptions.width : undefined),\n    height: toNumber(options.height, undefined),\n    getContainer: options.getContainer,\n    gap: [toNumber((_a = options.gap) === null || _a === void 0 ? void 0 : _a[0], defaultOptions.gap[0]), toNumber(((_b = options.gap) === null || _b === void 0 ? void 0 : _b[1]) || ((_c = options.gap) === null || _c === void 0 ? void 0 : _c[0]), defaultOptions.gap[1])]\n  });\n  _options.offset = [toNumber((_d = _options.offset) === null || _d === void 0 ? void 0 : _d[0], _options.gap[0] / 2), toNumber(((_e = _options.offset) === null || _e === void 0 ? void 0 : _e[1]) || ((_f = _options.offset) === null || _f === void 0 ? void 0 : _f[0]), _options.gap[0] / 2)];\n  return _options;\n};\nexport default function useWatermark(params) {\n  var _a = __read(useState(params || {}), 2),\n    options = _a[0],\n    setOptions = _a[1];\n  var watermarkDiv = useRef();\n  var mutationObserver = useRef();\n  var mergeOptions = getMergeOptions(options);\n  var zIndex = mergeOptions.zIndex,\n    gap = mergeOptions.gap;\n  var container = isServerRendering ? null : (options === null || options === void 0 ? void 0 : options.getContainer) ? options.getContainer() : defaultOptions.getContainer();\n  var setOrResetContainer = function (dom, type) {\n    var _a, _b;\n    if (!container || !dom) {\n      return;\n    }\n    var dataKey = 'data-arco-watermark-origin-position';\n    if (type === 'set') {\n      container.append(dom);\n      container.setAttribute(dataKey, ((_a = container.style) === null || _a === void 0 ? void 0 : _a.position) || '');\n      container.style.position = 'relative';\n    } else {\n      (_b = dom.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(dom);\n      container.style.position = container.getAttribute(dataKey);\n      container.removeAttribute(dataKey);\n    }\n  };\n  var clearMutationObserver = function () {\n    if (mutationObserver.current) {\n      mutationObserver.current.disconnect();\n    }\n    mutationObserver.current = null;\n  };\n  var createWatermarkElement = function () {\n    if (container) {\n      var div = document.createElement('div');\n      watermarkDiv.current = div;\n      setOrResetContainer(watermarkDiv.current, 'set');\n      return div;\n    }\n  };\n  // 清除元素和监听等\n  var clearEffect = function () {\n    clearMutationObserver();\n    var dom = watermarkDiv.current;\n    watermarkDiv.current = null;\n    setOrResetContainer(dom, 'reset');\n  };\n  var setWaterMark = function () {\n    if (!container) {\n      return;\n    }\n    getCanvasData(mergeOptions).then(function (_a) {\n      var _b;\n      var base64Url = _a.base64Url,\n        width = _a.width,\n        height = _a.height;\n      clearMutationObserver();\n      var wmStyle = \"\\n  width:100%;\\n  height:100%;\\n  position:absolute;\\n  top:0;\\n  left:0;\\n  bottom:0;\\n  right:0;\\n  pointer-events: none;\\n  z-index:\" + zIndex + \";\\n  background-position: 0 0;\\n  background-size:\" + (gap[0] + width) + \"px \" + (gap[1] + height) + \"px;\\n  background-repeat: repeat;\\n  background-image:url(\" + base64Url + \")\";\n      if (!watermarkDiv.current) {\n        createWatermarkElement();\n      }\n      (_b = watermarkDiv.current) === null || _b === void 0 ? void 0 : _b.setAttribute('style', wmStyle.trim());\n      if (container) {\n        mutationObserver.current = new MutationObserver(function (mutations) {\n          var isChanged = mutations.some(function (record) {\n            var target = record.target;\n            if (target) {\n              // watermarkDiv 被删除时会触发\n              if (target.isSameNode(container)) {\n                var changedNodes = [].slice.call(record.removedNodes).concat([].slice.call(record.addedNodes).map(function (x) {\n                  return x.parentNode;\n                }));\n                return changedNodes.some(function (x) {\n                  return x === watermarkDiv.current;\n                });\n              }\n              if (target.isSameNode(watermarkDiv.current) && record.type === 'attributes') {\n                return true;\n              }\n            }\n          });\n          if (isChanged) {\n            clearEffect();\n            setWaterMark();\n          }\n        });\n        mutationObserver.current.observe(container, {\n          attributes: true,\n          subtree: true,\n          childList: true\n        });\n      }\n    });\n  };\n  useEffect(function () {\n    setWaterMark();\n  }, [options]);\n  useEffect(function () {\n    clearEffect();\n    // 销毁重建\n    setWaterMark();\n    return function () {\n      clearEffect();\n    };\n  }, [container]);\n  return {\n    setWatermark: function (newOptions) {\n      setOptions(merge({}, options, newOptions));\n    },\n    destroy: function () {\n      clearEffect();\n    }\n  };\n}","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__read","o","m","r","ar","error","merge","useEffect","useRef","useState","isServerRendering","getPixelRatio","isNumber","toNumber","defaultValue","numberVal","parseFloat","defaultOptions","width","gap","fontStyle","fontSize","color","fontFamily","fontWeight","getContainer","document","measureTextSize","ctx","contents","rotate","height","lineSize","forEach","content","_a","measureText","textWidth","fontBoundingBoxAscent","fontBoundingBoxDescent","textHeight","angle","Math","PI","originWidth","originHeight","ceil","abs","sin","cos","getCanvasData","options","offset","image","canvas","ratio","setCanvas","renderContent","createElement","getContext","concat","canvasWidth","canvasHeight","setAttribute","style","translate","scale","RotateAngle","realFontSize","font","measureSize","fillStyle","textBaseline","index","lineHeight","lineWidth","xStartPoint","yStartPoint","fillText","base64Url","toDataURL","img","Image","crossOrigin","referrerPolicy","src","onload","drawImage","onerror","getMergeOptions","_b","_c","_d","_e","_f","_options","zIndex","undefined","useWatermark","params","setOptions","watermarkDiv","mutationObserver","mergeOptions","container","setOrResetContainer","dom","type","dataKey","append","position","parentNode","removeChild","getAttribute","removeAttribute","clearMutationObserver","current","disconnect","createWatermarkElement","div","clearEffect","setWaterMark","wmStyle","trim","MutationObserver","mutations","isChanged","some","record","target","isSameNode","changedNodes","slice","removedNodes","addedNodes","map","x","observe","attributes","subtree","childList","setWatermark","newOptions","destroy"],"sources":["D:/Nodejs/oj-frontend/node_modules/@arco-design/web-react/es/_hooks/useWatermark/index.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport merge from 'lodash/merge';\nimport { useEffect, useRef, useState } from 'react';\nimport { isServerRendering } from '../../_util/dom';\nimport { getPixelRatio } from './utils';\nimport { isNumber } from '../../_util/is';\nvar toNumber = function (value, defaultValue) {\n    if (isNumber(value)) {\n        return value;\n    }\n    var numberVal = parseFloat(value);\n    return isNumber(numberVal) ? numberVal : defaultValue;\n};\nvar defaultOptions = {\n    width: 100,\n    gap: [100, 100],\n    fontStyle: {\n        fontSize: '16px',\n        color: 'rgba(0, 0, 0, 0.15)',\n        fontFamily: 'sans-serif',\n        fontWeight: 'normal',\n    },\n    getContainer: function () { return document.body; },\n};\n// 计量文本宽度和高度。\nvar measureTextSize = function (ctx, contents, rotate) {\n    var width = 0;\n    var height = 0;\n    var lineSize = [];\n    contents.forEach(function (content) {\n        var _a = ctx.measureText(content), textWidth = _a.width, fontBoundingBoxAscent = _a.fontBoundingBoxAscent, fontBoundingBoxDescent = _a.fontBoundingBoxDescent;\n        var textHeight = fontBoundingBoxAscent + fontBoundingBoxDescent;\n        if (textWidth > width) {\n            width = textWidth;\n        }\n        height += textHeight;\n        lineSize.push({ height: textHeight, width: textWidth });\n    });\n    var angle = (rotate * Math.PI) / 180;\n    return {\n        originWidth: width,\n        originHeight: height,\n        // rotate 旋转后的实际占位宽度\n        width: Math.ceil(Math.abs(Math.sin(angle) * height) + Math.abs(Math.cos(angle) * width)),\n        // rotate 旋转后的实际占位高度\n        height: Math.ceil(Math.abs(Math.sin(angle) * width) + Math.abs(height * Math.cos(angle))),\n        lineSize: lineSize,\n    };\n};\n// 画布绘制转为base64url\nvar getCanvasData = function (options) { return __awaiter(void 0, void 0, void 0, function () {\n    var offset, rotate, image, content, fontStyle, canvas, ctx, ratio, contents, setCanvas, renderContent;\n    return __generator(this, function (_a) {\n        offset = options.offset, rotate = options.rotate, image = options.image, content = options.content, fontStyle = options.fontStyle;\n        canvas = document.createElement('canvas');\n        ctx = canvas.getContext('2d');\n        ratio = getPixelRatio(ctx);\n        contents = [].concat(content || '');\n        setCanvas = function (_a) {\n            var height = _a.height, width = _a.width;\n            var canvasWidth = 2 * offset[0] + width;\n            var canvasHeight = 2 * offset[1] + height;\n            canvas.setAttribute('width', canvasWidth * ratio + \"px\");\n            canvas.setAttribute('height', canvasHeight * ratio + \"px\");\n            canvas.style.width = canvasWidth + \"px\";\n            canvas.style.height = canvasHeight + \"px\";\n            ctx.translate((canvasWidth * ratio) / 2, (canvasHeight * ratio) / 2);\n            ctx.scale(ratio, ratio);\n            var RotateAngle = (rotate * Math.PI) / 180;\n            ctx.rotate(RotateAngle);\n        };\n        renderContent = function () {\n            var fontSize = fontStyle.fontSize, color = fontStyle.color, fontWeight = fontStyle.fontWeight, fontFamily = fontStyle.fontFamily;\n            var realFontSize = toNumber(fontSize, 0) || fontStyle.fontSize;\n            // font, scale 需参与文本尺寸计量\n            ctx.font = fontWeight + \" \" + realFontSize + \"px \" + fontFamily;\n            var measureSize = measureTextSize(ctx, contents, rotate);\n            var width = options.width || measureSize.width;\n            var height = options.height || measureSize.height;\n            setCanvas({ width: width, height: height });\n            ctx.fillStyle = color;\n            ctx.font = fontWeight + \" \" + realFontSize + \"px \" + fontFamily;\n            // 如果不设置，会导致旋转后的部分文字被遮盖\n            ctx.textBaseline = 'top';\n            contents.forEach(function (content, index) {\n                var _a = measureSize.lineSize[index], lineHeight = _a.height, lineWidth = _a.width;\n                var xStartPoint = -lineWidth / 2;\n                var yStartPoint = -(options.height || measureSize.originHeight) / 2 + lineHeight * index;\n                ctx.fillText(content, xStartPoint, yStartPoint, options.width || measureSize.originWidth);\n            });\n            return { base64Url: canvas.toDataURL(), height: height, width: width };\n        };\n        if (image) {\n            return [2 /*return*/, new Promise(function (resolve) {\n                    var img = new Image();\n                    img.crossOrigin = 'anonymous';\n                    img.referrerPolicy = 'no-referrer';\n                    img.src = image;\n                    img.onload = function () {\n                        var width = options.width, height = options.height;\n                        if (!width || !height) {\n                            if (width) {\n                                height = (img.height / img.width) * width;\n                            }\n                            else {\n                                width = (img.width / img.height) * height;\n                            }\n                        }\n                        setCanvas({ width: width, height: height });\n                        ctx.drawImage(img, -width / 2, -height / 2, width, height);\n                        return resolve({ base64Url: canvas.toDataURL(), width: width, height: height });\n                    };\n                    img.onerror = function () {\n                        return renderContent();\n                    };\n                })];\n        }\n        return [2 /*return*/, renderContent()];\n    });\n}); };\nvar getMergeOptions = function (o) {\n    var _a, _b, _c, _d, _e, _f;\n    var options = o || {};\n    var _options = __assign(__assign({ rotate: -20, zIndex: 1 }, options), { fontStyle: __assign(__assign({}, defaultOptions.fontStyle), options.fontStyle), width: toNumber(options.width, options.image ? defaultOptions.width : undefined), height: toNumber(options.height, undefined), getContainer: options.getContainer, gap: [\n            toNumber((_a = options.gap) === null || _a === void 0 ? void 0 : _a[0], defaultOptions.gap[0]),\n            toNumber(((_b = options.gap) === null || _b === void 0 ? void 0 : _b[1]) || ((_c = options.gap) === null || _c === void 0 ? void 0 : _c[0]), defaultOptions.gap[1]),\n        ] });\n    _options.offset = [\n        toNumber((_d = _options.offset) === null || _d === void 0 ? void 0 : _d[0], _options.gap[0] / 2),\n        toNumber(((_e = _options.offset) === null || _e === void 0 ? void 0 : _e[1]) || ((_f = _options.offset) === null || _f === void 0 ? void 0 : _f[0]), _options.gap[0] / 2),\n    ];\n    return _options;\n};\nexport default function useWatermark(params) {\n    var _a = __read(useState(params || {}), 2), options = _a[0], setOptions = _a[1];\n    var watermarkDiv = useRef();\n    var mutationObserver = useRef();\n    var mergeOptions = getMergeOptions(options);\n    var zIndex = mergeOptions.zIndex, gap = mergeOptions.gap;\n    var container = isServerRendering\n        ? null\n        : (options === null || options === void 0 ? void 0 : options.getContainer)\n            ? options.getContainer()\n            : defaultOptions.getContainer();\n    var setOrResetContainer = function (dom, type) {\n        var _a, _b;\n        if (!container || !dom) {\n            return;\n        }\n        var dataKey = 'data-arco-watermark-origin-position';\n        if (type === 'set') {\n            container.append(dom);\n            container.setAttribute(dataKey, ((_a = container.style) === null || _a === void 0 ? void 0 : _a.position) || '');\n            container.style.position = 'relative';\n        }\n        else {\n            (_b = dom.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(dom);\n            container.style.position = container.getAttribute(dataKey);\n            container.removeAttribute(dataKey);\n        }\n    };\n    var clearMutationObserver = function () {\n        if (mutationObserver.current) {\n            mutationObserver.current.disconnect();\n        }\n        mutationObserver.current = null;\n    };\n    var createWatermarkElement = function () {\n        if (container) {\n            var div = document.createElement('div');\n            watermarkDiv.current = div;\n            setOrResetContainer(watermarkDiv.current, 'set');\n            return div;\n        }\n    };\n    // 清除元素和监听等\n    var clearEffect = function () {\n        clearMutationObserver();\n        var dom = watermarkDiv.current;\n        watermarkDiv.current = null;\n        setOrResetContainer(dom, 'reset');\n    };\n    var setWaterMark = function () {\n        if (!container) {\n            return;\n        }\n        getCanvasData(mergeOptions).then(function (_a) {\n            var _b;\n            var base64Url = _a.base64Url, width = _a.width, height = _a.height;\n            clearMutationObserver();\n            var wmStyle = \"\\n  width:100%;\\n  height:100%;\\n  position:absolute;\\n  top:0;\\n  left:0;\\n  bottom:0;\\n  right:0;\\n  pointer-events: none;\\n  z-index:\" + zIndex + \";\\n  background-position: 0 0;\\n  background-size:\" + (gap[0] + width) + \"px \" + (gap[1] + height) + \"px;\\n  background-repeat: repeat;\\n  background-image:url(\" + base64Url + \")\";\n            if (!watermarkDiv.current) {\n                createWatermarkElement();\n            }\n            (_b = watermarkDiv.current) === null || _b === void 0 ? void 0 : _b.setAttribute('style', wmStyle.trim());\n            if (container) {\n                mutationObserver.current = new MutationObserver(function (mutations) {\n                    var isChanged = mutations.some(function (record) {\n                        var target = record.target;\n                        if (target) {\n                            // watermarkDiv 被删除时会触发\n                            if (target.isSameNode(container)) {\n                                var changedNodes = [].slice\n                                    .call(record.removedNodes)\n                                    .concat([].slice.call(record.addedNodes).map(function (x) { return x.parentNode; }));\n                                return changedNodes.some(function (x) { return x === watermarkDiv.current; });\n                            }\n                            if (target.isSameNode(watermarkDiv.current) && record.type === 'attributes') {\n                                return true;\n                            }\n                        }\n                    });\n                    if (isChanged) {\n                        clearEffect();\n                        setWaterMark();\n                    }\n                });\n                mutationObserver.current.observe(container, {\n                    attributes: true,\n                    subtree: true,\n                    childList: true,\n                });\n            }\n        });\n    };\n    useEffect(function () {\n        setWaterMark();\n    }, [options]);\n    useEffect(function () {\n        clearEffect();\n        // 销毁重建\n        setWaterMark();\n        return function () {\n            clearEffect();\n        };\n    }, [container]);\n    return {\n        setWatermark: function (newOptions) {\n            setOptions(merge({}, options, newOptions));\n        },\n        destroy: function () {\n            clearEffect();\n        },\n    };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}